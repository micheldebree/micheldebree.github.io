(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{217:function(e,t,a){},218:function(e,t,a){},246:function(e,t){},248:function(e,t){},497:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(23),c=a.n(o),r=(a(217),a(9)),l=a(523),s=a(524),j=a(201),b=a(525),u=a(521),d=a(518),h=a(520),f=(a(218),a(198)),O=a.n(f),m=a(522),p=a(66),g=a.n(p),x=a(191),v=a.n(x),C=a(192),w=a.n(C),S=a(194),y=a.n(S),I=a(193),E=a.n(I),k=a(21);function D(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,void 0!==e?new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height):void 0}}function R(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function z(e,t){if(e.length<=t)return e;var a=R(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}var P=a(90),F=a(199),B=a(526),A=a(531),M=a(527),W=a(2);function N(e){var t=i.a.useRef(null),a=e.width,o=e.height,c=e.imageData;return Object(n.useEffect)((function(){void 0!==c&&t.current.getContext("2d").putImageData(c,0,0)}),[c]),Object(W.jsx)(B.a,{m:1,children:Object(W.jsx)("canvas",{ref:t,width:a,height:o})})}N.defaultProps={imageData:void 0};var T=N;function G(e){var t=e.onload,a=e.imageData,i=Object(n.useState)(void 0),o=Object(r.a)(i,2),c=o[0],l=o[1],s=Object(F.a)({accept:"image/*",maxFiles:1}),b=s.acceptedFiles,u=s.fileRejections,h=s.getRootProps,f=s.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){g.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b]),Object(n.useEffect)((function(){if(void 0!==u&&u.length>0){var e=u[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[u]),Object(W.jsxs)(d.a,{children:[Object(W.jsx)(B.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(W.jsxs)("div",Object(P.a)(Object(P.a)({},h({className:"dropzone"})),{},{children:[Object(W.jsx)("input",Object(P.a)({},f())),Object(W.jsx)(T,{width:320,height:200,imageData:a}),Object(W.jsx)(j.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(W.jsx)(A.a,{open:c,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(W.jsx)(M.a,{severity:"error",children:c})})]})}G.defaultProps={imageData:void 0};var H=G,L=a(532),q=a(533),J=a(534),U=a(535),_=a(519),Q=a(528);function Z(e){var t=e.label,a=e.value,n=e.items,i=e.onChange,o=e.tooltip;return Object(W.jsx)(L.a,{title:o,children:Object(W.jsxs)(q.a,{component:"fieldset",children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(U.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return i(e.target.value)},children:n.map((function(e){return Object(W.jsx)(_.a,{value:e,control:Object(W.jsx)(Q.a,{}),label:e})}))})]})})}Z.defaultProps={label:"Choose"};var V=Z,K=a(530);var X=function(e){var t=e.name,a=e.label,n=e.value,i=e.onChange,o=e.tooltip;return Object(W.jsx)(L.a,{title:o,arrow:!0,children:Object(W.jsx)(_.a,{control:Object(W.jsx)(K.a,{checked:n,onChange:function(){i(!n)},name:"".concat(t,"Checkbox")}),label:a})})},Y=a(536);function $(e){var t=e.label,a=e.value,n=e.min,i=e.max,o=e.step,c=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(L.a,{title:r,arrow:!0,children:Object(W.jsxs)(h.a,{container:!0,children:[Object(W.jsxs)(h.a,{item:!0,children:[l," \xa0"]}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(Y.a,{min:n,max:i,step:o,value:a,onChange:function(e,t){return c(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}$.defaultProps={min:0,step:1,disabled:!1};var ee=$,te=a(110),ae=a.n(te);function ne(e){var t=e.onClick,a=e.disabled;return Object(W.jsx)(d.a,{align:"left",children:Object(W.jsx)(L.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(W.jsx)(u.a,{size:"small",disabled:a,startIcon:Object(W.jsx)(ae.a,{}),onClick:t,children:"defaults"})})})}ne.defaultProps={disabled:!1};var ie=ne;var oe=function(e){var t=e.onChanged,a=!0,i=!1,o=!1,c=!1,l=!1,s=Object(n.useState)(void 0),j=Object(r.a)(s,2),b=j[0],u=j[1],h=Object(n.useState)(void 0),f=Object(r.a)(h,2),O=f[0],m=f[1],g=Object(n.useState)(void 0),x=Object(r.a)(g,2),C=x[0],S=x[1],I=Object(n.useState)(void 0),k=Object(r.a)(I,2),R=k[0],P=k[1],F=Object(n.useState)("input"),B=Object(r.a)(F,2),A=B[0],M=B[1],N=Object(n.useState)("fill"),T=Object(r.a)(N,2),G=T[0],L=T[1],q=Object(n.useState)(a),J=Object(r.a)(q,2),U=J[0],_=J[1],Q=Object(n.useState)(i),Z=Object(r.a)(Q,2),K=Z[0],Y=Z[1],$=Object(n.useState)(o),te=Object(r.a)($,2),ae=te[0],ne=te[1],oe=Object(n.useState)(c),ce=Object(r.a)(oe,2),re=ce[0],le=ce[1],se=Object(n.useState)(l),je=Object(r.a)(se,2),be=je[0],ue=je[1],de=Object(n.useState)(0),he=Object(r.a)(de,2),fe=he[0],Oe=he[1],me=Object(n.useState)(0),pe=Object(r.a)(me,2),ge=pe[0],xe=pe[1],ve=Object(n.useState)(0),Ce=Object(r.a)(ve,2),we=Ce[0],Se=Ce[1],ye=Object(n.useState)(0),Ie=Object(r.a)(ye,2),Ee=Ie[0],ke=Ie[1];Object(n.useEffect)((function(){void 0!==C&&(t({jimpImage:C,filename:A}),P(D(C)))}),[C,t,A]),Object(n.useEffect)((function(){if(void 0!==b){var e=b.clone();"fill"===G?e.cover(320,200,p.RESIZE_HERMITE):"fit"===G?e.contain(320,200,p.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(e),m(e)}}),[b,G]),Object(n.useEffect)((function(){if(void 0!==O){var e=O.clone();K&&e.greyscale(),U&&e.normalize(),e.brightness(fe),e.contrast(ge),we>0&&e.blur(we),e.mirror(ae,re),be&&e.invert(),Ee>0&&e.threshold({max:Ee,autoGreyscale:!1}),S(e)}}),[O,U,fe,ge,K,we,ae,re,be,Ee]);var De=U===a&&K===i&&ae===o&&re===c&&be===l&&0===ge&&0===fe&&0===we&&0===Ee;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h4",{children:z(A,30)}),Object(W.jsx)(d.a,{children:Object(W.jsx)(H,{imageData:R,onload:function(e){u(e.jimpImage),M(e.filename)}})}),Object(W.jsx)(d.a,{align:"left",children:Object(W.jsx)(V,{label:"cropping",items:["crop","fill","fit"],value:G,onChange:function(e){L(e)},tooltip:"Type of cropping to apply to source image"})}),Object(W.jsx)(ie,{onClick:function(){_(a),Y(i),ne(o),le(c),ue(l),Oe(0),xe(0),Se(0),ke(0)},disabled:De}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(X,{name:"normalize",label:"normalize",value:U,onChange:function(e){return _(e)},tooltip:"Stretch color intensities to their full range"}),Object(W.jsx)(X,{name:"greyscale",label:"greyscale",value:K,onChange:function(e){return Y(e)},tooltip:"Convert to black and white"}),Object(W.jsx)(X,{name:"invert",label:"invert",value:be,onChange:function(e){return ue(e)},tooltip:"Invert colors"}),Object(W.jsx)(X,{name:"mirrorHor",label:"flip horizontal",value:ae,onChange:function(e){return ne(e)},tooltip:"Mirror image horizontally"}),Object(W.jsx)(X,{name:"mirrorVer",label:"flip vertical",value:re,onChange:function(e){return le(e)},tooltip:"Mirror image vertically"}),Object(W.jsx)(ee,{label:"brightness",value:fe,min:-1,max:1,step:.05,onChange:function(e){return Oe(e)},tooltip:"Adjust image brightness",icon:Object(W.jsx)(v.a,{})}),Object(W.jsx)(ee,{label:"contrast",value:ge,min:-1,max:1,step:.05,onChange:function(e){return xe(e)},tooltip:"Adjust image contrast",icon:Object(W.jsx)(w.a,{})}),Object(W.jsx)(ee,{label:"blur",value:we,max:10,onChange:function(e){return Se(e)},tooltip:"Blur image by this many pixels",icon:Object(W.jsx)(E.a,{})}),Object(W.jsx)(ee,{label:"threshold",value:Ee,max:255,onChange:function(e){return ke(e)},tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(W.jsx)(y.a,{})})]})]})},ce=a(197),re=a.n(ce),le=a(196),se=a.n(le),je=a(195),be=a(58),ue=a.n(be);function de(e){var t=k.GraphicModes.all.bitmap,a=e.jimpImage,i=e.onChanged,o=e.hires,c=e.nomaps,l=e.colorspaceId,s=e.paletteId,j=e.ditherId,b=e.ditherRadius,u=new k.Quantizer(k.Palettes.all[s],k.ColorSpaces.all[l]),d=new k.Converter(u),h=new ue.a(ue.a.presets[j],b),f=Object(n.useState)(void 0),O=Object(r.a)(f,2),m=O[0],p=O[1],g=Object(n.useState)(void 0),x=Object(r.a)(g,2),v=x[0],C=x[1],w=Object(n.useState)(u),S=Object(r.a)(w,2),y=S[0],I=S[1],E=Object(n.useState)(d),D=Object(r.a)(E,2),R=D[0],z=D[1],P=Object(n.useState)(h),F=Object(r.a)(P,2),B=F[0],A=F[1];return Object(n.useEffect)((function(){I(new k.Quantizer(k.Palettes.all[s],k.ColorSpaces.all[l]))}),[l,s]),Object(n.useEffect)((function(){z(new k.Converter(y))}),[y]),Object(n.useEffect)((function(){A(new ue.a(ue.a.presets[j],b))}),[j,b]),Object(n.useEffect)((function(){if(void 0!==a){var e=t({hires:o,nomaps:c}),n=a.clone();n.resize(e.mode.width,e.mode.height),"none"!==j&&B.dither(n.bitmap),n.opaque(),R.convert(n.bitmap,e),p(e)}}),[a,R,B,o,c,t]),Object(n.useEffect)((function(){C(function(e){if(void 0===e)return new ImageData(1,1);for(var t=e.mode.width*e.mode.pixelWidth,a=new ImageData(t,e.mode.height),n=0;n<e.mode.height;n++)for(var i=0;i<e.mode.width;i++)for(var o=e.peek(i,n),c=void 0!==o?k.Palettes.all.colodore.get(o):[0,0,0,0],r=0;r<e.mode.pixelWidth;r++){var l=4*n*t+i*e.mode.pixelWidth*4+4*r;a.data[l]=c[0],a.data[l+1]=c[1],a.data[l+2]=c[2],a.data[l+3]=255}return a}(m)),i(m)}),[m,i]),Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(T,{width:320,height:200,imageData:v})})}de.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",paletteId:"colodore",ditherId:"bayer4x4",ditherRadius:32};var he=de;function fe(e){var t="bayer4x4",a="colodore",i="xyz",o=!1,c=!1,l=e.jimpImage,s=e.filename,j=Object(n.useState)(void 0),b=Object(r.a)(j,2),h=b[0],f=b[1],O=Object(n.useState)(i),m=Object(r.a)(O,2),p=m[0],g=m[1],x=Object(n.useState)(a),v=Object(r.a)(x,2),C=v[0],w=v[1],S=Object(n.useState)(o),y=Object(r.a)(S,2),I=y[0],E=y[1],D=Object(n.useState)(c),z=Object(r.a)(D,2),P=z[0],F=z[1],B=Object(n.useState)(t),A=Object(r.a)(B,2),M=A[0],N=A[1],T=Object(n.useState)(32),G=Object(r.a)(T,2),H=G[0],q=G[1],J="output";if(void 0!==h){var U=1===h.mode.pixelWidth?".art":".kla",_=R(s);J="".concat(_.basename.substring(0,30)).concat(U)}var Q="output";void 0!==h&&(Q=1===h.mode.pixelWidth?"art studio file":"koala painter file");var Z=p===i&&C===a&&I===o&&P===c&&M===t&&32===H;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h4",{children:Q}),Object(W.jsx)(d.a,{children:Object(W.jsx)(he,{jimpImage:l,onChanged:function(e){f(e)},hires:I,nomaps:P,colorspaceId:p,paletteId:C,ditherId:M,ditherRadius:H})}),Object(W.jsx)(d.a,{children:Object(W.jsx)(L.a,{title:"Download the image as ".concat(Q),arrow:!0,children:Object(W.jsx)(u.a,{variant:"contained",disabled:void 0===h,color:"primary",startIcon:Object(W.jsx)(se.a,{}),onClick:function(){return function(){var e=k.C64Writer.toBinary(h),t=k.C64Writer.toBuffer(e),a=new Blob([t],{type:"application/octet-stream"});Object(je.saveAs)(a,J)}()},children:"Download"})})}),Object(W.jsx)(ie,{onClick:function(){g(i),w(a),E(o),F(c),N(t),q(32)},disabled:Z}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(X,{name:"hires",label:"hires",value:I,onChange:function(e){return E(e)},tooltip:"Use high resolution mode instead of multi color"}),Object(W.jsx)(X,{name:"nomaps",label:"single color layers",value:P,onChange:function(e){return F(e)},tooltip:"Restrict each attribute layer to a single color"})]}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(V,{label:"colorspace",value:p,items:["rgb","yuv","xyz","rainbow"],onChange:function(e){return g(e)},tooltip:"Convert colors to this color space before quantizing"}),Object(W.jsx)(V,{label:"palette",value:C,items:["colodore","pepto","deekay"],onChange:function(e){return w(e)},tooltip:"Use this palette for quantizing"}),Object(W.jsx)(V,{label:"dithering",value:M,items:["none","bayer2x2","bayer4x4","bayer8x8"],onChange:function(e){return N(e)},tooltip:"Type of dithering to apply"}),Object(W.jsx)(ee,{label:"dithering strength",value:H,max:64,onChange:function(e){return q(e)},tooltip:"Strength of dithering",icon:Object(W.jsx)(re.a,{}),disabled:"none"===M})]})]})}fe.defaultProps={jimpImage:void 0,filename:"output"};var Oe=fe,me=a.p+"static/media/logo.42e2fcaf.svg",pe="2021-05-29.104f741",ge="https://github.com/micheldebree/retropixels/commit/104f741bf8a006fc9650a0d8287ac81e4be06016",xe=Object(m.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var ve=function(){var e=Object(n.useState)(void 0),t=Object(r.a)(e,2),a=t[0],i=t[1],o=Object(n.useState)(void 0),c=Object(r.a)(o,2),f=c[0],m=c[1],p=xe();return Object(W.jsx)("div",{className:"App",children:Object(W.jsxs)("body",{className:"App-body",children:[Object(W.jsx)("div",{className:p.root,children:Object(W.jsx)(l.a,{position:"static",children:Object(W.jsxs)(s.a,{variant:"dense",children:[Object(W.jsx)("img",{src:me,alt:"Logo",className:"logo"}),Object(W.jsx)(j.a,{variant:"h6",className:p.title,align:"left",children:"Retropixels"}),Object(W.jsxs)(b.a,{href:ge,color:"inherit",variant:"body2",children:["v",pe]}),Object(W.jsx)(u.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(W.jsx)(O.a,{})})]})})}),Object(W.jsx)(d.a,{align:"left",children:Object(W.jsxs)(j.a,{variant:"overline",children:["Convert images to ",Object(W.jsx)(b.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(W.jsxs)(h.a,{container:!0,spacing:3,children:[Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(oe,{onChanged:function(e){i(e.jimpImage),m(e.filename)}})}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(Oe,{jimpImage:a,filename:f})})]})]})})},Ce=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,538)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),i(e),o(e),c(e)}))};c.a.render(Object(W.jsx)(i.a.StrictMode,{children:Object(W.jsx)(ve,{})}),document.getElementById("root")),Ce()}},[[497,1,2]]]);
//# sourceMappingURL=main.bdb68249.chunk.js.map