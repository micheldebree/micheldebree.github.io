(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{218:function(e,t,a){},219:function(e,t,a){},247:function(e,t){},249:function(e,t){},499:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(23),o=a.n(i),r=(a(218),a(9)),l=a(528),s=a(529),j=a(204),b=a(530),d=a(523),u=a(520),h=a(522),O=(a(219),a(201)),m=a.n(O),f=a(527),x=a(67),g=a.n(x),p=a(193),v=a.n(p),C=a(194),w=a.n(C),S=a(196),y=a.n(S),I=a(195),k=a.n(I);function D(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function E(e,t){if(e.length<=t)return e;var a=D(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}var R=a(54),z=a(202),P=a(531),F=a(536),B=a(532),A=a(2);function M(e){var t=c.a.useRef(null),a=e.width,i=e.height,o=e.imageData;return Object(n.useEffect)((function(){void 0!==o&&t.current.getContext("2d").putImageData(o,0,0)}),[o]),Object(A.jsx)(P.a,{m:2,children:Object(A.jsx)("canvas",{ref:t,width:a,height:i})})}M.defaultProps={imageData:void 0};var W=M;function N(e){var t=e.onload,a=e.imageData,c=Object(n.useState)(void 0),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(z.a)({accept:"image/*",maxFiles:1}),b=s.acceptedFiles,d=s.fileRejections,h=s.getRootProps,O=s.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){g.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b,t]),Object(n.useEffect)((function(){if(void 0!==d&&d.length>0){var e=d[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[d]),Object(A.jsxs)(u.a,{children:[Object(A.jsx)(P.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(A.jsxs)("div",Object(R.a)(Object(R.a)({},h({className:"dropzone"})),{},{children:[Object(A.jsx)("input",Object(R.a)({},O())),Object(A.jsx)(W,{width:320,height:200,imageData:a}),Object(A.jsx)(j.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(A.jsx)(F.a,{open:o,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(A.jsx)(B.a,{severity:"error",children:o})})]})}N.defaultProps={imageData:void 0};var T=N,G=a(537),H=a(538),L=a(539),J=a(540),U=a(521),_=a(533);function q(e){var t=e.label,a=e.value,n=e.items,c=e.onChange,i=e.tooltip;return Object(A.jsx)(G.a,{title:i,children:Object(A.jsxs)(H.a,{component:"fieldset",children:[Object(A.jsx)(L.a,{component:"legend",children:t}),Object(A.jsx)(J.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return c(e.target.value)},children:n.map((function(e){return Object(A.jsx)(U.a,{value:e,control:Object(A.jsx)(_.a,{}),label:e},e)}))})]})})}q.defaultProps={label:"Choose"};var Q=q,Z=a(535);var V=function(e){var t=e.name,a=e.label,n=e.value,c=e.onChange,i=e.tooltip;return Object(A.jsx)(G.a,{title:i,arrow:!0,children:Object(A.jsx)(U.a,{control:Object(A.jsx)(Z.a,{checked:n,onChange:function(e){return c(e.target.checked)},name:"".concat(t,"Checkbox")}),label:a})})},K=a(541);function X(e){var t=e.label,a=e.value,n=e.min,c=e.max,i=e.step,o=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(L.a,{component:"legend",children:t}),Object(A.jsx)(G.a,{title:r,arrow:!0,children:Object(A.jsxs)(h.a,{container:!0,children:[Object(A.jsxs)(h.a,{item:!0,children:[l," \xa0"]}),Object(A.jsx)(h.a,{item:!0,xs:!0,children:Object(A.jsx)(K.a,{min:n,max:c,step:i,value:a,onChange:function(e,t){return o(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}X.defaultProps={min:0,step:1,disabled:!1};var Y=X,$=a(192),ee=a.n($);function te(e){var t=e.onClick,a=e.disabled;return Object(A.jsx)(P.a,{align:"left",m:2,children:Object(A.jsx)(G.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(A.jsx)(d.a,{size:"small",variant:"outlined",disabled:a,startIcon:Object(A.jsx)(ee.a,{}),onClick:t,children:"defaults"})})})}te.defaultProps={disabled:!1};var ae=te,ne=!0,ce=!1,ie=!1,oe=!1,re=!1;var le=function(e){var t=e.onChanged,a=Object(n.useState)(void 0),c=Object(r.a)(a,2),i=c[0],o=c[1],l=Object(n.useState)(void 0),s=Object(r.a)(l,2),j=s[0],b=s[1],d=Object(n.useState)(void 0),h=Object(r.a)(d,2),O=h[0],m=h[1],f=Object(n.useState)(void 0),g=Object(r.a)(f,2),p=g[0],C=g[1],S=Object(n.useState)("input"),I=Object(r.a)(S,2),D=I[0],R=I[1],z=Object(n.useState)("fill"),P=Object(r.a)(z,2),F=P[0],B=P[1],M=Object(n.useState)(ne),W=Object(r.a)(M,2),N=W[0],G=W[1],H=Object(n.useState)(ce),L=Object(r.a)(H,2),J=L[0],U=L[1],_=Object(n.useState)(ie),q=Object(r.a)(_,2),Z=q[0],K=q[1],X=Object(n.useState)(oe),$=Object(r.a)(X,2),ee=$[0],te=$[1],le=Object(n.useState)(re),se=Object(r.a)(le,2),je=se[0],be=se[1],de=Object(n.useState)(0),ue=Object(r.a)(de,2),he=ue[0],Oe=ue[1],me=Object(n.useState)(0),fe=Object(r.a)(me,2),xe=fe[0],ge=fe[1],pe=Object(n.useState)(0),ve=Object(r.a)(pe,2),Ce=ve[0],we=ve[1],Se=Object(n.useState)(0),ye=Object(r.a)(Se,2),Ie=ye[0],ke=ye[1],De=Object(n.useCallback)((function(e){o(e.jimpImage),R(e.filename)}),[]);Object(n.useEffect)((function(){void 0!==O&&(t({jimpImage:O,filename:D}),C(function(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,void 0!==e?new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height):void 0}}(O)))}),[O,t,D]),Object(n.useEffect)((function(){void 0!==i&&b(function(e,t){var a=e.clone();return"fill"===t?a.cover(320,200,x.RESIZE_HERMITE):"fit"===t?a.contain(320,200,x.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(a),a}(i,F))}),[i,F]),Object(n.useEffect)((function(){if(void 0!==j){var e=j.clone();J&&e.greyscale(),N&&e.normalize(),e.brightness(he),e.contrast(xe),Ce>0&&e.blur(Ce),e.mirror(Z,ee),je&&e.invert(),Ie>0&&e.threshold({max:Ie,autoGreyscale:!1}),m(e)}}),[j,N,he,xe,J,Ce,Z,ee,je,Ie]);var Ee=N===ne&&J===ce&&Z===ie&&ee===oe&&je===re&&0===xe&&0===he&&0===Ce&&0===Ie;return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("h4",{children:E(D,30)}),Object(A.jsx)(u.a,{children:Object(A.jsx)(T,{imageData:p,onload:De})}),Object(A.jsx)(u.a,{align:"left",children:Object(A.jsx)(Q,{label:"cropping",items:["crop","fill","fit"],value:F,onChange:B,tooltip:"Type of cropping to apply to source image"})}),Object(A.jsx)(ae,{onClick:function(){G(ne),U(ce),K(ie),te(oe),be(re),Oe(0),ge(0),we(0),ke(0)},disabled:Ee}),Object(A.jsxs)(u.a,{align:"left",children:[Object(A.jsx)(V,{name:"normalize",label:"normalize",value:N,onChange:G,tooltip:"Stretch color intensities to their full range"}),Object(A.jsx)(V,{name:"greyscale",label:"greyscale",value:J,onChange:U,tooltip:"Convert to black and white"}),Object(A.jsx)(V,{name:"invert",label:"invert",value:je,onChange:function(e){return be(e)},tooltip:"Invert colors"}),Object(A.jsx)(V,{name:"mirrorHor",label:"flip horizontal",value:Z,onChange:K,tooltip:"Mirror image horizontally"}),Object(A.jsx)(V,{name:"mirrorVer",label:"flip vertical",value:ee,onChange:te,tooltip:"Mirror image vertically"}),Object(A.jsx)(Y,{label:"brightness",value:he,min:-1,max:1,step:.05,onChange:Oe,tooltip:"Adjust image brightness",icon:Object(A.jsx)(v.a,{})}),Object(A.jsx)(Y,{label:"contrast",value:xe,min:-1,max:1,step:.05,onChange:ge,tooltip:"Adjust image contrast",icon:Object(A.jsx)(w.a,{})}),Object(A.jsx)(Y,{label:"blur",value:Ce,max:10,onChange:we,tooltip:"Blur image by this many pixels",icon:Object(A.jsx)(k.a,{})}),Object(A.jsx)(Y,{label:"threshold",value:Ie,max:255,onChange:ke,tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(A.jsx)(y.a,{})})]})]})},se=a(200),je=a.n(se),be=a(199),de=a.n(be),ue=a(21),he=a(197),Oe=ue.GraphicModes.all.bitmap;function me(e){var t=e.jimpImage,a=e.onChanged,c=e.hires,i=e.nomaps,o=e.colorspaceId,l=e.palette,s=e.ditherId,j=e.ditherRadius,b=new ue.Quantizer(l,ue.ColorSpaces.all[o]),d=new ue.Converter(b),u=new ue.OrderedDither(ue.OrderedDither.presets[s],j),h=Object(n.useState)(void 0),O=Object(r.a)(h,2),m=O[0],f=O[1],x=Object(n.useState)(void 0),g=Object(r.a)(x,2),p=g[0],v=g[1],C=Object(n.useState)(d),w=Object(r.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(u),k=Object(r.a)(I,2),D=k[0],E=k[1];return Object(n.useEffect)((function(){var e=new ue.Quantizer(l,ue.ColorSpaces.all[o]);y(new ue.Converter(e))}),[o,l]),Object(n.useEffect)((function(){E(new ue.OrderedDither(ue.OrderedDither.presets[s],j))}),[s,j]),Object(n.useEffect)((function(){if(void 0!==t){var e=Oe({hires:c,nomaps:i}),a=function(e,t){var a=e.clone();return a.resize(t.mode.width,t.mode.height),a}(t,e);D.dither(a.bitmap),f(e),S.convert(a.bitmap,e),f(e)}}),[t,c,i,S,D]),Object(n.useEffect)((function(){v(function(e){if(void 0===e)return new ImageData(1,1);for(var t=e.mode.width*e.mode.pixelWidth,a=new ImageData(t,e.mode.height),n=0;n<e.mode.height;n+=1)for(var c=0;c<e.mode.width;c+=1)for(var i=e.peek(c,n),o=void 0!==i?ue.Palettes.all.colodore.colors[i]:[0,0,0,0],l=0;l<e.mode.pixelWidth;l+=1){var s=4*n*t+c*e.mode.pixelWidth*4+4*l,j=Object(r.a)(o,3),b=j[0],d=j[1],u=j[2];a.data[s]=b,a.data[s+1]=d,a.data[s+2]=u,a.data[s+3]=255}return a}(m)),a(m)}),[m,a]),Object(A.jsx)(W,{width:320,height:200,imageData:p})}me.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",palette:ue.Palettes.all.colodore,ditherId:"bayer4x4",ditherRadius:32};var fe=me,xe=a(524),ge=a(525),pe=a(526),ve=a(198),Ce=a.n(ve),we=["colodore","pepto"],Se="colodore";var ye=function(e){var t=e.onChange,a={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0},c=Object(n.useState)(Se),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(n.useState)(ue.Palettes.all[o]),j=Object(r.a)(s,2),b=j[0],d=j[1],O=Object(n.useState)(a),m=Object(r.a)(O,2),f=m[0],x=m[1],g=Object(n.useMemo)((function(){return Object.keys(f).filter((function(e){return f[e]}))}),[f]);Object(n.useEffect)((function(){var e=Object(R.a)({},ue.Palettes.all[o]);e.enabled=g,d(e)}),[o,g]),Object(n.useEffect)((function(){t(b)}),[b,t]);var p=g.length===b.colors.length&&o===Se;function v(e){return function(){var t=!f[e];if(t||!(g.length<=1)){var a=Object(R.a)({},f);a[e]=t,x(a)}}}function C(e){for(var t=[],a=e;a<e+8;a+=1){var n=Object(r.a)(b.colors[a],3),c=n[0],i=n[1],o=n[2],l="".concat(c).concat(i).concat(o);t.push(Object(A.jsxs)(xe.a,{children:[Object(A.jsx)(ge.a,{children:Object(A.jsx)(Z.a,{checked:f[a],onChange:v(a),name:"".concat(l,"cb")})}),Object(A.jsx)(P.a,{boxShadow:1,borderRadius:"borderRadius",children:Object(A.jsx)(Ce.a,{fontSize:"small",style:{color:"rgb(".concat(c,", ").concat(i,", ").concat(o,")")}})})]},l))}return t}return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(h.a,{container:!0,children:[Object(A.jsxs)(h.a,{item:!0,xs:12,align:"left",children:[Object(A.jsx)(ae,{onClick:function(){x(a),l(Se)},disabled:p}),Object(A.jsx)(u.a,{align:"left",children:Object(A.jsx)(Q,{label:"palette",value:o,items:we,onChange:l,tooltip:"Use this palette for quantizing"})})]}),Object(A.jsx)(h.a,{item:!0,xs:6,children:Object(A.jsx)(pe.a,{dense:!0,children:C(0)})}),Object(A.jsx)(h.a,{item:!0,xs:6,children:Object(A.jsx)(pe.a,{dense:!0,children:C(8)})})]})})},Ie=["none","bayer2x2","bayer4x4","bayer8x8"],ke=["rgb","yuv","xyz","rainbow"],De="bayer4x4",Ee=ue.Palettes.all.colodore,Re="xyz",ze=!1,Pe=!1;function Fe(e){var t=e.jimpImage,a=e.filename,c=Object(n.useState)(void 0),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(n.useState)(Re),j=Object(r.a)(s,2),b=j[0],O=j[1],m=Object(n.useState)(Ee),f=Object(r.a)(m,2),x=f[0],g=f[1],p=Object(n.useState)(ze),v=Object(r.a)(p,2),C=v[0],w=v[1],S=Object(n.useState)(Pe),y=Object(r.a)(S,2),I=y[0],k=y[1],E=Object(n.useState)(De),R=Object(r.a)(E,2),z=R[0],P=R[1],F=Object(n.useState)(32),B=Object(r.a)(F,2),M=B[0],W=B[1],N=Object(n.useCallback)((function(e){return g(e)}),[]),T=Object(n.useCallback)((function(e){return l(e)}),[]),H="output";if(void 0!==o){var L=function(e){return 1===e.mode.pixelWidth?".art":".kla"}(o),J=D(a);H="".concat(J.basename.substring(0,30)).concat(L)}var U="output";void 0!==o&&(U=1===o.mode.pixelWidth?"art studio file":"koala painter file");var _=b===Re&&C===ze&&I===Pe&&z===De&&32===M;return Object(A.jsxs)(h.a,{container:!0,children:[Object(A.jsxs)(h.a,{item:!0,xs:12,sm:12,md:6,children:[Object(A.jsx)("h4",{children:U}),Object(A.jsx)(u.a,{children:Object(A.jsx)(fe,{jimpImage:t,onChanged:T,hires:C,nomaps:I,colorspaceId:b,palette:x,ditherId:z,ditherRadius:M})}),Object(A.jsx)(u.a,{children:Object(A.jsx)(G.a,{title:"Download the image as ".concat(U),arrow:!0,children:Object(A.jsx)(d.a,{variant:"contained",disabled:void 0===o,color:"primary",startIcon:Object(A.jsx)(de.a,{}),onClick:function(){return function(e,t){var a=ue.C64Writer.toBinary(e),n=ue.C64Writer.toBuffer(a),c=new Blob([n],{type:"application/octet-stream"});Object(he.saveAs)(c,t)}(o,H)},children:"Download"})})}),Object(A.jsx)(ae,{onClick:function(){O(Re),w(ze),k(Pe),P(De),W(32)},disabled:_}),Object(A.jsxs)(u.a,{align:"left",children:[Object(A.jsx)(V,{name:"hires",label:"hires",value:C,onChange:w,tooltip:"Use high resolution mode instead of multi color"}),Object(A.jsx)(V,{name:"nomaps",label:"single color layers",value:I,onChange:k,tooltip:"Restrict each attribute layer to a single color"})]}),Object(A.jsxs)(u.a,{align:"left",children:[Object(A.jsx)(Q,{label:"colorspace",value:b,items:ke,onChange:O,tooltip:"Convert colors to this color space before quantizing"}),Object(A.jsx)(Q,{label:"dithering",value:z,items:Ie,onChange:P,tooltip:"Type of dithering to apply"}),Object(A.jsx)(Y,{label:"dithering strength",value:M,max:64,onChange:W,tooltip:"Strength of dithering",icon:Object(A.jsx)(je.a,{}),disabled:"none"===z})]})]}),Object(A.jsxs)(h.a,{item:!0,xs:!0,children:[Object(A.jsx)("h4",{children:"palette"}),Object(A.jsx)(ye,{onChange:N})]})]})}Fe.defaultProps={jimpImage:void 0,filename:"output"};var Be=Fe,Ae=a.p+"static/media/logo.42e2fcaf.svg",Me="2021-06-12.860cf59",We="https://github.com/micheldebree/retropixels/commit/860cf59dc205b7a598dfc710c1b60809885bdc21",Ne=Object(f.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var Te=function(){var e=Object(n.useState)(void 0),t=Object(r.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(void 0),o=Object(r.a)(i,2),O=o[0],f=o[1],x=Ne();return Object(A.jsx)("div",{className:"App",children:Object(A.jsxs)("body",{className:"App-body",children:[Object(A.jsx)("div",{className:x.root,children:Object(A.jsx)(l.a,{position:"static",children:Object(A.jsxs)(s.a,{variant:"dense",children:[Object(A.jsx)("img",{src:Ae,alt:"Logo",className:"logo"}),Object(A.jsx)(j.a,{variant:"h6",className:x.title,align:"left",children:"Retropixels"}),Object(A.jsxs)(b.a,{href:We,color:"inherit",variant:"body2",children:["v",Me]}),Object(A.jsx)(d.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(A.jsx)(m.a,{})})]})})}),Object(A.jsx)(u.a,{align:"left",children:Object(A.jsxs)(j.a,{variant:"overline",children:["Convert images to ",Object(A.jsx)(b.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(A.jsxs)(h.a,{container:!0,spacing:3,children:[Object(A.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(A.jsx)(le,{onChanged:function(e){c(e.jimpImage),f(e.filename)}})}),Object(A.jsx)(h.a,{item:!0,xs:12,sm:6,md:8,children:Object(A.jsx)(Be,{jimpImage:a,filename:O})})]})]})})},Ge=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,543)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),i(e),o(e)}))};o.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(Te,{})}),document.getElementById("root")),Ge()}},[[499,1,2]]]);
//# sourceMappingURL=main.bfed1b99.chunk.js.map