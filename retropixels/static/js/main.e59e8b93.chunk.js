(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{246:function(e,t,a){},247:function(e,t,a){},268:function(e,t){},270:function(e,t){},508:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(213),o=(a(246),a(8)),r=a(583),l=a(584),s=a(577),j=a(585),b=a(575),d=a(571),u=a(574),h=(a(247),a(228)),O=a.n(h),m=a(562),f=a(229),x=a(586),g=a(58),p=a.n(g),v=a(221),C=a.n(v),w=a(222),S=a.n(w),y=a(224),I=a.n(y),k=a(223),E=a.n(k);function D(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function R(e,t){if(e.length<=t)return e;var a=D(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}function P(e,t){if(void 0===e)return new ImageData(1,1);for(var a=e.mode.width*e.mode.pixelWidth,n=new ImageData(a,e.mode.height),c=0;c<e.mode.height;c+=1)for(var i=0;i<e.mode.width;i+=1)for(var r=e.peek(i,c),l=void 0!==r?t.colors[r]:[0,0,0,0],s=0;s<e.mode.pixelWidth;s+=1){var j=4*c*a+i*e.mode.pixelWidth*4+4*s,b=Object(o.a)(l,3),d=b[0],u=b[1],h=b[2];n.data[j]=d,n.data[j+1]=u,n.data[j+2]=h,n.data[j+3]=255}return n}var z=a(66),A=a(230),B=a(576),M=a(567),F=a(563),W=a(1);function N(e){var t=c.a.useRef(null),a=e.width,i=e.height,o=e.imageData;return Object(n.useEffect)((function(){void 0!==o&&t.current.getContext("2d").putImageData(o,0,0)}),[o]),Object(W.jsx)(B.a,{m:2,children:Object(W.jsx)("canvas",{ref:t,width:a,height:i})})}N.defaultProps={imageData:void 0};var L=N;function T(e){var t=e.onload,a=e.imageData,c=Object(n.useState)(void 0),i=Object(o.a)(c,2),r=i[0],l=i[1],j=Object(A.a)({accept:"image/*",maxFiles:1}),b=j.acceptedFiles,u=j.fileRejections,h=j.getRootProps,O=j.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){p.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b,t]),Object(n.useEffect)((function(){if(void 0!==u&&u.length>0){var e=u[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[u]),Object(W.jsxs)(d.a,{children:[Object(W.jsx)(B.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(W.jsxs)("div",Object(z.a)(Object(z.a)({},h({className:"dropzone"})),{},{children:[Object(W.jsx)("input",Object(z.a)({},O())),Object(W.jsx)(L,{width:320,height:200,imageData:a}),Object(W.jsx)(s.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(W.jsx)(M.a,{open:r,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(W.jsx)(F.a,{severity:"error",children:r})})]})}T.defaultProps={imageData:void 0};var G=T,H=a(561),_=a(572),J=a(579),U=a(573),q=a(580),Q=a(566);function Z(e){var t=e.label,a=e.value,n=e.items,c=e.onChange,i=e.tooltip;return Object(W.jsx)(H.a,{title:i,children:Object(W.jsxs)(_.a,{component:"fieldset",children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(U.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return c(e.target.value)},children:n.map((function(e){return Object(W.jsx)(q.a,{value:e,control:Object(W.jsx)(Q.a,{}),label:e},e)}))})]})})}Z.defaultProps={label:"Choose"};var V=Z,K=a(568);var X=function(e){var t=e.name,a=e.label,n=e.value,c=e.onChange,i=e.tooltip;return Object(W.jsx)(H.a,{title:i,arrow:!0,children:Object(W.jsx)(q.a,{control:Object(W.jsx)(K.a,{checked:n,onChange:function(e){return c(e.target.checked)},name:"".concat(t,"Checkbox")}),label:a})})},Y=a(565);function $(e){var t=e.label,a=e.value,n=e.min,c=e.max,i=e.step,o=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(H.a,{title:r,arrow:!0,children:Object(W.jsxs)(u.a,{container:!0,children:[Object(W.jsxs)(u.a,{item:!0,children:[l," \xa0"]}),Object(W.jsx)(u.a,{item:!0,xs:!0,children:Object(W.jsx)(Y.a,{min:n,max:c,step:i,value:a,onChange:function(e,t){return o(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}$.defaultProps={min:0,step:1,disabled:!1};var ee=$,te=a(220),ae=a.n(te);function ne(e){var t=e.onClick,a=e.disabled;return Object(W.jsx)(B.a,{align:"left",m:2,children:Object(W.jsx)(H.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(W.jsx)(b.a,{size:"small",variant:"outlined",disabled:a,startIcon:Object(W.jsx)(ae.a,{}),onClick:t,children:"defaults"})})})}ne.defaultProps={disabled:!1};var ce=ne,ie=!0,oe=!1,re=!1,le=!1,se=!1;var je=function(e){var t=e.onChanged,a=Object(n.useState)(void 0),c=Object(o.a)(a,2),i=c[0],r=c[1],l=Object(n.useState)(void 0),s=Object(o.a)(l,2),j=s[0],b=s[1],u=Object(n.useState)(void 0),h=Object(o.a)(u,2),O=h[0],m=h[1],f=Object(n.useState)(void 0),x=Object(o.a)(f,2),p=x[0],v=x[1],w=Object(n.useState)("input"),y=Object(o.a)(w,2),k=y[0],D=y[1],P=Object(n.useState)("fill"),z=Object(o.a)(P,2),A=z[0],B=z[1],M=Object(n.useState)(ie),F=Object(o.a)(M,2),N=F[0],L=F[1],T=Object(n.useState)(oe),H=Object(o.a)(T,2),_=H[0],J=H[1],U=Object(n.useState)(re),q=Object(o.a)(U,2),Q=q[0],Z=q[1],K=Object(n.useState)(le),Y=Object(o.a)(K,2),$=Y[0],te=Y[1],ae=Object(n.useState)(se),ne=Object(o.a)(ae,2),je=ne[0],be=ne[1],de=Object(n.useState)(0),ue=Object(o.a)(de,2),he=ue[0],Oe=ue[1],me=Object(n.useState)(0),fe=Object(o.a)(me,2),xe=fe[0],ge=fe[1],pe=Object(n.useState)(0),ve=Object(o.a)(pe,2),Ce=ve[0],we=ve[1],Se=Object(n.useState)(0),ye=Object(o.a)(Se,2),Ie=ye[0],ke=ye[1],Ee=Object(n.useCallback)((function(e){r(e.jimpImage),D(e.filename)}),[]),De=Object(n.useCallback)((function(){L(ie),J(oe),Z(re),te(le),be(se),Oe(0),ge(0),we(0),ke(0)}),[]);Object(n.useEffect)((function(){void 0!==O&&(t({jimpImage:O,filename:k}),v(function(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height)}}(O)))}),[O,t,k]),Object(n.useEffect)((function(){void 0!==i&&b(function(e,t){var a=e.clone();return"fill"===t?a.cover(320,200,g.RESIZE_HERMITE):"fit"===t?a.contain(320,200,g.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(a),a}(i,A))}),[i,A]),Object(n.useEffect)((function(){if(void 0!==j){var e=j.clone();_&&e.greyscale(),N&&e.normalize(),e.brightness(he),e.contrast(xe),Ce>0&&e.blur(Ce),e.mirror(Q,$),je&&e.invert(),Ie>0&&e.threshold({max:Ie,autoGreyscale:!1}),m(e)}}),[j,N,he,xe,_,Ce,Q,$,je,Ie]);var Re=N===ie&&_===oe&&Q===re&&$===le&&je===se&&0===xe&&0===he&&0===Ce&&0===Ie;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h4",{children:R(k,30)}),Object(W.jsx)(d.a,{children:Object(W.jsx)(G,{imageData:p,onload:Ee})}),Object(W.jsx)(d.a,{align:"left",children:Object(W.jsx)(V,{label:"cropping",items:["crop","fill","fit"],value:A,onChange:B,tooltip:"Type of cropping to apply to source image"})}),Object(W.jsx)(ce,{onClick:De,disabled:Re}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(X,{name:"normalize",label:"normalize",value:N,onChange:L,tooltip:"Stretch color intensities to their full range"}),Object(W.jsx)(X,{name:"greyscale",label:"greyscale",value:_,onChange:J,tooltip:"Convert to black and white"}),Object(W.jsx)(X,{name:"invert",label:"invert",value:je,onChange:function(e){return be(e)},tooltip:"Invert colors"}),Object(W.jsx)(X,{name:"mirrorHor",label:"flip horizontal",value:Q,onChange:Z,tooltip:"Mirror image horizontally"}),Object(W.jsx)(X,{name:"mirrorVer",label:"flip vertical",value:$,onChange:te,tooltip:"Mirror image vertically"}),Object(W.jsx)(ee,{label:"brightness",value:he,min:-1,max:1,step:.05,onChange:Oe,tooltip:"Adjust image brightness",icon:Object(W.jsx)(C.a,{})}),Object(W.jsx)(ee,{label:"contrast",value:xe,min:-1,max:1,step:.05,onChange:ge,tooltip:"Adjust image contrast",icon:Object(W.jsx)(S.a,{})}),Object(W.jsx)(ee,{label:"blur",value:Ce,max:10,onChange:we,tooltip:"Blur image by this many pixels",icon:Object(W.jsx)(E.a,{})}),Object(W.jsx)(ee,{label:"threshold",value:Ie,max:255,onChange:ke,tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(W.jsx)(I.a,{})})]})]})},be=a(227),de=a.n(be),ue=a(138),he=a.n(ue),Oe=a(31),me=a(137),fe=Oe.GraphicModes.all.bitmap;function xe(e){var t=e.jimpImage,a=e.onChanged,c=e.hires,i=e.nomaps,r=e.colorspaceId,l=e.palette,s=e.ditherId,j=e.ditherRadius,b=new Oe.Quantizer(l,Oe.ColorSpaces.all[r]),d=new Oe.Converter(b),u=new Oe.OrderedDither(Oe.OrderedDither.presets[s],j),h=Object(n.useState)(void 0),O=Object(o.a)(h,2),m=O[0],f=O[1],x=Object(n.useState)(void 0),g=Object(o.a)(x,2),p=g[0],v=g[1],C=Object(n.useState)(d),w=Object(o.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(u),k=Object(o.a)(I,2),E=k[0],D=k[1];return Object(n.useEffect)((function(){var e=new Oe.Quantizer(l,Oe.ColorSpaces.all[r]);y(new Oe.Converter(e))}),[r,l]),Object(n.useEffect)((function(){D(new Oe.OrderedDither(Oe.OrderedDither.presets[s],j))}),[s,j]),Object(n.useEffect)((function(){if(void 0!==t){var e=fe({hires:c,nomaps:i}),a=function(e,t){var a=e.clone();return a.resize(t.mode.width,t.mode.height),a}(t,e);E.dither(a.bitmap),f(e),S.convert(a.bitmap,e),f(e)}}),[t,c,i,S,E]),Object(n.useEffect)((function(){v(P(m,l)),a(m)}),[m,a,l]),Object(W.jsx)(L,{width:320,height:200,imageData:p})}xe.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",palette:Oe.Palettes.all.colodore,ditherId:"bayer4x4",ditherRadius:32};var ge=xe,pe=a(569),ve=a(581),Ce=a(582),we=a(225),Se=a.n(we),ye=["PALette","colodore","pepto"],Ie="PALette",ke={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0};var Ee=function(e){var t=e.onChange,a=Object(n.useState)(Ie),c=Object(o.a)(a,2),i=c[0],r=c[1],l=Object(n.useState)(Oe.Palettes.all[i]),s=Object(o.a)(l,2),j=s[0],b=s[1],h=Object(n.useState)(ke),O=Object(o.a)(h,2),m=O[0],f=O[1],x=Object(n.useMemo)((function(){return Object.keys(m).filter((function(e){return m[e]}))}),[m]);Object(n.useEffect)((function(){var e=Object(z.a)({},Oe.Palettes.all[i]);e.enabled=x,b(e)}),[i,x]),Object(n.useEffect)((function(){t(j)}),[j,t]);var g=x.length===j.colors.length&&i===Ie,p=Object(n.useCallback)((function(){f(ke),r(Ie)}),[]);function v(e){return function(){var t=!m[e];if(t||!(x.length<=1)){var a=Object(z.a)({},m);a[e]=t,f(a)}}}function C(e){for(var t=[],a=e;a<e+8;a+=1){var n=Object(o.a)(j.colors[a],3),c=n[0],i=n[1],r=n[2],l="".concat(c).concat(i).concat(r);t.push(Object(W.jsxs)(pe.a,{children:[Object(W.jsx)(ve.a,{children:Object(W.jsx)(K.a,{checked:m[a],onChange:v(a),name:"".concat(l,"cb")})}),Object(W.jsx)(B.a,{boxShadow:1,borderRadius:"borderRadius",children:Object(W.jsx)(Se.a,{fontSize:"small",style:{color:"rgb(".concat(c,", ").concat(i,", ").concat(r,")")}})})]},l))}return t}return Object(W.jsxs)(u.a,{container:!0,children:[Object(W.jsxs)(u.a,{item:!0,xs:12,align:"left",children:[Object(W.jsx)(ce,{onClick:p,disabled:g}),Object(W.jsx)(d.a,{align:"left",children:Object(W.jsx)(V,{label:"palette",value:i,items:ye,onChange:r,tooltip:"Use this palette for quantizing"})})]}),Object(W.jsx)(u.a,{item:!0,xs:6,children:Object(W.jsx)(Ce.a,{dense:!0,children:C(0)})}),Object(W.jsx)(u.a,{item:!0,xs:6,children:Object(W.jsx)(Ce.a,{dense:!0,children:C(8)})})]})},De=["none","bayer2x2","bayer4x4","bayer8x8"],Re=["rgb","yuv","xyz","rainbow"],Pe="bayer4x4",ze=Oe.Palettes.all.colodore,Ae="xyz",Be=!1,Me=!1,Fe=Object(m.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function We(e){var t,a=e.jimpImage,c=e.filename,i=Object(n.useState)(void 0),r=Object(o.a)(i,2),l=r[0],s=r[1],j=Object(n.useState)(Ae),h=Object(o.a)(j,2),O=h[0],m=h[1],f=Object(n.useState)(ze),x=Object(o.a)(f,2),g=x[0],v=x[1],C=Object(n.useState)(Be),w=Object(o.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(Me),k=Object(o.a)(I,2),E=k[0],R=k[1],z=Object(n.useState)(Pe),A=Object(o.a)(z,2),B=A[0],M=A[1],F=Object(n.useState)(32),N=Object(o.a)(F,2),L=N[0],T=N[1],G=Object(n.useCallback)((function(e){return v(e)}),[]),_=Object(n.useCallback)((function(e){return s(e)}),[]),J="output";if(void 0!==l){var U=function(e){return 1===e.mode.pixelWidth?".art":".kla"}(l),q=D(c);J="".concat(q.basename).concat(U),t="".concat(q.basename,".png")}var Q=Object(n.useCallback)((function(){m(Ae),y(Be),R(Me),M(Pe),T(32)}),[]),Z="output";void 0!==l&&(Z=1===l.mode.pixelWidth?"art studio":"koala painter");var K=O===Ae&&S===Be&&E===Me&&B===Pe&&32===L,Y=Fe();return Object(W.jsxs)(u.a,{container:!0,children:[Object(W.jsxs)(u.a,{item:!0,xs:12,sm:12,md:6,children:[Object(W.jsx)("h4",{children:J}),Object(W.jsx)(d.a,{children:Object(W.jsx)(ge,{jimpImage:a,onChanged:_,hires:S,nomaps:E,colorspaceId:O,palette:g,ditherId:B,ditherRadius:L})}),Object(W.jsxs)(d.a,{align:"left",className:Y.root,children:[Object(W.jsx)(H.a,{title:"Download the image as ".concat(Z," file"),arrow:!0,children:Object(W.jsx)(b.a,{sx:{marginRight:"2em"},variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(W.jsx)(he.a,{}),onClick:function(){return function(e,t){var a=Oe.C64Writer.toBinary(e),n=Oe.C64Writer.toBuffer(a),c=new Blob([n],{type:"application/octet-stream"});Object(me.saveAs)(c,t)}(l,J)},children:Z})}),Object(W.jsx)(H.a,{title:"Download the image",arrow:!0,children:Object(W.jsx)(b.a,{variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(W.jsx)(he.a,{}),onClick:function(){return function(e,t,a){var n=e.mode.width*e.mode.pixelWidth,c=e.mode.height;new p.a(n,c,(function(n,c){if(n)throw n;var i=P(e,t);c.bitmap.width=i.width,c.bitmap.height=i.height,c.bitmap.data=i.data,c.getBufferAsync(p.a.MIME_PNG).then((function(e){var t=new Blob([e],{type:"application/octet-stream"});Object(me.saveAs)(t,a)}))}))}(l,g,t)},children:"Image"})})]}),Object(W.jsx)(ce,{onClick:Q,disabled:K}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(X,{name:"hires",label:"hires",value:S,onChange:y,tooltip:"Use high resolution mode instead of multi color"}),Object(W.jsx)(X,{name:"nomaps",label:"single color layers",value:E,onChange:R,tooltip:"Restrict each attribute layer to a single color"})]}),Object(W.jsxs)(d.a,{align:"left",children:[Object(W.jsx)(V,{label:"colorspace",value:O,items:Re,onChange:m,tooltip:"Convert colors to this color space before quantizing"}),Object(W.jsx)(V,{label:"dithering",value:B,items:De,onChange:M,tooltip:"Type of dithering to apply"}),Object(W.jsx)(ee,{label:"dithering strength",value:L,max:64,onChange:T,tooltip:"Strength of dithering",icon:Object(W.jsx)(de.a,{}),disabled:"none"===B})]})]}),Object(W.jsxs)(u.a,{item:!0,xs:!0,children:[Object(W.jsx)("h4",{children:"palette"}),Object(W.jsx)(Ee,{onChange:G})]})]})}We.defaultProps={jimpImage:void 0,filename:"output"};var Ne=We,Le=a.p+"static/media/logo.42e2fcaf.svg",Te="2022-06-14.80eabec",Ge="https://github.com/micheldebree/retropixels/commit/80eabecf3855da4ac5bd59da171f4ea9dfbe2a85",He=Object(f.a)(),_e=Object(m.a)((function(){return{root:{flexGrow:1},menuButton:{marginRight:He.spacing(2)},title:{flexGrow:1}}}));var Je=function(){var e=Object(n.useState)(void 0),t=Object(o.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(void 0),h=Object(o.a)(i,2),m=h[0],f=h[1],g=_e(),p=Object(n.useCallback)((function(e){c(e.jimpImage),f(e.filename)}),[c,f]);return Object(W.jsx)(x.a,{theme:He,children:Object(W.jsxs)("div",{className:"App",children:[Object(W.jsx)("div",{className:g.root,children:Object(W.jsx)(r.a,{position:"static",children:Object(W.jsxs)(l.a,{variant:"dense",children:[Object(W.jsx)("img",{src:Le,alt:"Logo",className:"logo"}),Object(W.jsx)(s.a,{variant:"h6",className:g.title,align:"left",children:"Retropixels"}),Object(W.jsxs)(j.a,{href:Ge,color:"inherit",variant:"body2",children:["v",Te]}),Object(W.jsx)(b.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(W.jsx)(O.a,{})})]})})}),Object(W.jsx)(d.a,{align:"left",children:Object(W.jsxs)(s.a,{variant:"overline",children:["Convert images to ",Object(W.jsx)(j.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(W.jsxs)(u.a,{container:!0,spacing:3,children:[Object(W.jsx)(u.a,{item:!0,xs:12,sm:6,md:4,children:Object(W.jsx)(je,{onChanged:p})}),Object(W.jsx)(u.a,{item:!0,xs:12,sm:6,md:8,children:Object(W.jsx)(Ne,{jimpImage:a,filename:m})})]})]})})},Ue=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,587)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),i(e),o(e)}))},qe=document.getElementById("root");Object(i.createRoot)(qe).render(Object(W.jsx)(c.a.StrictMode,{children:Object(W.jsx)(Je,{})})),Ue()}},[[508,1,2]]]);
//# sourceMappingURL=main.e59e8b93.chunk.js.map