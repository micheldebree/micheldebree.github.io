(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{218:function(e,t,a){},219:function(e,t,a){},247:function(e,t){},249:function(e,t){},499:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(23),o=a.n(i),r=(a(218),a(9)),l=a(528),s=a(529),j=a(204),b=a(530),d=a(523),u=a(520),h=a(522),O=(a(219),a(201)),f=a.n(O),m=a(527),x=a(67),p=a.n(x),g=a(193),v=a.n(g),C=a(194),S=a.n(C),w=a(196),y=a.n(w),I=a(195),E=a.n(I),k=a(17);function D(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,void 0!==e?new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height):void 0}}function R(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function z(e,t){if(e.length<=t)return e;var a=R(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}var P=a(54),F=a(202),B=a(531),A=a(536),M=a(532),W=a(2);function N(e){var t=c.a.useRef(null),a=e.width,i=e.height,o=e.imageData;return Object(n.useEffect)((function(){void 0!==o&&t.current.getContext("2d").putImageData(o,0,0)}),[o]),Object(W.jsx)(B.a,{m:1,children:Object(W.jsx)("canvas",{ref:t,width:a,height:i})})}N.defaultProps={imageData:void 0};var T=N;function G(e){var t=e.onload,a=e.imageData,c=Object(n.useState)(void 0),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(F.a)({accept:"image/*",maxFiles:1}),b=s.acceptedFiles,d=s.fileRejections,h=s.getRootProps,O=s.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){p.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b,t]),Object(n.useEffect)((function(){if(void 0!==d&&d.length>0){var e=d[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[d]),Object(W.jsxs)(u.a,{children:[Object(W.jsx)(B.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(W.jsxs)("div",Object(P.a)(Object(P.a)({},h({className:"dropzone"})),{},{children:[Object(W.jsx)("input",Object(P.a)({},O())),Object(W.jsx)(T,{width:320,height:200,imageData:a}),Object(W.jsx)(j.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(W.jsx)(A.a,{open:o,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(W.jsx)(M.a,{severity:"error",children:o})})]})}G.defaultProps={imageData:void 0};var H=G,L=a(537),q=a(538),J=a(539),U=a(540),_=a(521),Q=a(533);function Z(e){var t=e.label,a=e.value,n=e.items,c=e.onChange,i=e.tooltip;return Object(W.jsx)(L.a,{title:i,children:Object(W.jsxs)(q.a,{component:"fieldset",children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(U.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return c(e.target.value)},children:n.map((function(e){return Object(W.jsx)(_.a,{value:e,control:Object(W.jsx)(Q.a,{}),label:e},e)}))})]})})}Z.defaultProps={label:"Choose"};var V=Z,K=a(535);var X=function(e){var t=e.name,a=e.label,n=e.value,c=e.onChange,i=e.tooltip;return Object(W.jsx)(L.a,{title:i,arrow:!0,children:Object(W.jsx)(_.a,{control:Object(W.jsx)(K.a,{checked:n,onChange:function(){c(!n)},name:"".concat(t,"Checkbox")}),label:a})})},Y=a(541);function $(e){var t=e.label,a=e.value,n=e.min,c=e.max,i=e.step,o=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(J.a,{component:"legend",children:t}),Object(W.jsx)(L.a,{title:r,arrow:!0,children:Object(W.jsxs)(h.a,{container:!0,children:[Object(W.jsxs)(h.a,{item:!0,children:[l," \xa0"]}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(Y.a,{min:n,max:c,step:i,value:a,onChange:function(e,t){return o(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}$.defaultProps={min:0,step:1,disabled:!1};var ee=$,te=a(192),ae=a.n(te);function ne(e){var t=e.onClick,a=e.disabled;return Object(W.jsx)(B.a,{align:"left",m:2,children:Object(W.jsx)(L.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(W.jsx)(d.a,{size:"small",variant:"outlined",disabled:a,startIcon:Object(W.jsx)(ae.a,{}),onClick:t,children:"defaults"})})})}ne.defaultProps={disabled:!1};var ce=ne;var ie=function(e){var t=e.onChanged,a=!0,c=!1,i=!1,o=!1,l=!1,s=Object(n.useState)(void 0),j=Object(r.a)(s,2),b=j[0],d=j[1],h=Object(n.useState)(void 0),O=Object(r.a)(h,2),f=O[0],m=O[1],p=Object(n.useState)(void 0),g=Object(r.a)(p,2),C=g[0],w=g[1],I=Object(n.useState)(void 0),k=Object(r.a)(I,2),R=k[0],P=k[1],F=Object(n.useState)("input"),B=Object(r.a)(F,2),A=B[0],M=B[1],N=Object(n.useState)("fill"),T=Object(r.a)(N,2),G=T[0],L=T[1],q=Object(n.useState)(a),J=Object(r.a)(q,2),U=J[0],_=J[1],Q=Object(n.useState)(c),Z=Object(r.a)(Q,2),K=Z[0],Y=Z[1],$=Object(n.useState)(i),te=Object(r.a)($,2),ae=te[0],ne=te[1],ie=Object(n.useState)(o),oe=Object(r.a)(ie,2),re=oe[0],le=oe[1],se=Object(n.useState)(l),je=Object(r.a)(se,2),be=je[0],de=je[1],ue=Object(n.useState)(0),he=Object(r.a)(ue,2),Oe=he[0],fe=he[1],me=Object(n.useState)(0),xe=Object(r.a)(me,2),pe=xe[0],ge=xe[1],ve=Object(n.useState)(0),Ce=Object(r.a)(ve,2),Se=Ce[0],we=Ce[1],ye=Object(n.useState)(0),Ie=Object(r.a)(ye,2),Ee=Ie[0],ke=Ie[1],De=Object(n.useCallback)((function(e){d(e.jimpImage),M(e.filename)}),[]);Object(n.useEffect)((function(){void 0!==C&&(t({jimpImage:C,filename:A}),P(D(C)))}),[C,t,A]),Object(n.useEffect)((function(){if(void 0!==b){var e=b.clone();"fill"===G?e.cover(320,200,x.RESIZE_HERMITE):"fit"===G?e.contain(320,200,x.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(e),m(e)}}),[b,G]),Object(n.useEffect)((function(){if(void 0!==f){var e=f.clone();K&&e.greyscale(),U&&e.normalize(),e.brightness(Oe),e.contrast(pe),Se>0&&e.blur(Se),e.mirror(ae,re),be&&e.invert(),Ee>0&&e.threshold({max:Ee,autoGreyscale:!1}),w(e)}}),[f,U,Oe,pe,K,Se,ae,re,be,Ee]);var Re=U===a&&K===c&&ae===i&&re===o&&be===l&&0===pe&&0===Oe&&0===Se&&0===Ee;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("h4",{children:z(A,30)}),Object(W.jsx)(u.a,{children:Object(W.jsx)(H,{imageData:R,onload:De})}),Object(W.jsx)(u.a,{align:"left",children:Object(W.jsx)(V,{label:"cropping",items:["crop","fill","fit"],value:G,onChange:function(e){L(e)},tooltip:"Type of cropping to apply to source image"})}),Object(W.jsx)(ce,{onClick:function(){_(a),Y(c),ne(i),le(o),de(l),fe(0),ge(0),we(0),ke(0)},disabled:Re}),Object(W.jsxs)(u.a,{align:"left",children:[Object(W.jsx)(X,{name:"normalize",label:"normalize",value:U,onChange:function(e){return _(e)},tooltip:"Stretch color intensities to their full range"}),Object(W.jsx)(X,{name:"greyscale",label:"greyscale",value:K,onChange:function(e){return Y(e)},tooltip:"Convert to black and white"}),Object(W.jsx)(X,{name:"invert",label:"invert",value:be,onChange:function(e){return de(e)},tooltip:"Invert colors"}),Object(W.jsx)(X,{name:"mirrorHor",label:"flip horizontal",value:ae,onChange:function(e){return ne(e)},tooltip:"Mirror image horizontally"}),Object(W.jsx)(X,{name:"mirrorVer",label:"flip vertical",value:re,onChange:function(e){return le(e)},tooltip:"Mirror image vertically"}),Object(W.jsx)(ee,{label:"brightness",value:Oe,min:-1,max:1,step:.05,onChange:function(e){return fe(e)},tooltip:"Adjust image brightness",icon:Object(W.jsx)(v.a,{})}),Object(W.jsx)(ee,{label:"contrast",value:pe,min:-1,max:1,step:.05,onChange:function(e){return ge(e)},tooltip:"Adjust image contrast",icon:Object(W.jsx)(S.a,{})}),Object(W.jsx)(ee,{label:"blur",value:Se,max:10,onChange:function(e){return we(e)},tooltip:"Blur image by this many pixels",icon:Object(W.jsx)(E.a,{})}),Object(W.jsx)(ee,{label:"threshold",value:Ee,max:255,onChange:function(e){return ke(e)},tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(W.jsx)(y.a,{})})]})]})},oe=a(200),re=a.n(oe),le=a(199),se=a.n(le),je=a(197);function be(e){var t=k.GraphicModes.all.bitmap,a=e.jimpImage,c=e.onChanged,i=e.hires,o=e.nomaps,l=e.colorspaceId,s=e.palette,j=e.ditherId,b=e.ditherRadius,d=new k.Quantizer(s,k.ColorSpaces.all[l]),u=new k.Converter(d),h=new k.OrderedDither(k.OrderedDither.presets[j],b),O=Object(n.useState)(void 0),f=Object(r.a)(O,2),m=f[0],x=f[1],p=Object(n.useState)(void 0),g=Object(r.a)(p,2),v=g[0],C=g[1],S=Object(n.useState)(d),w=Object(r.a)(S,2),y=w[0],I=w[1],E=Object(n.useState)(u),D=Object(r.a)(E,2),R=D[0],z=D[1],P=Object(n.useState)(h),F=Object(r.a)(P,2),B=F[0],A=F[1];return Object(n.useEffect)((function(){I(new k.Quantizer(s,k.ColorSpaces.all[l]))}),[l,s]),Object(n.useEffect)((function(){z(new k.Converter(y))}),[y]),Object(n.useEffect)((function(){A(new k.OrderedDither(k.OrderedDither.presets[j],b))}),[j,b]),Object(n.useEffect)((function(){if(void 0!==a){var e=t({hires:i,nomaps:o}),n=a.clone();n.resize(e.mode.width,e.mode.height),B.dither(n.bitmap),n.opaque(),R.convert(n.bitmap,e),x(e)}}),[a,R,B,i,o,t]),Object(n.useEffect)((function(){C(function(e){if(void 0===e)return new ImageData(1,1);for(var t=e.mode.width*e.mode.pixelWidth,a=new ImageData(t,e.mode.height),n=0;n<e.mode.height;n+=1)for(var c=0;c<e.mode.width;c+=1)for(var i=e.peek(c,n),o=void 0!==i?k.Palettes.all.colodore.colors[i]:[0,0,0,0],l=0;l<e.mode.pixelWidth;l+=1){var s=4*n*t+c*e.mode.pixelWidth*4+4*l,j=Object(r.a)(o,3),b=j[0],d=j[1],u=j[2];a.data[s]=b,a.data[s+1]=d,a.data[s+2]=u,a.data[s+3]=255}return a}(m)),c(m)}),[m,c]),Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(T,{width:320,height:200,imageData:v})})}be.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",palette:k.Palettes.all.colodore,ditherId:"bayer4x4",ditherRadius:32};var de=be,ue=a(524),he=a(525),Oe=a(526),fe=a(198),me=a.n(fe),xe=["colodore","pepto"],pe="colodore";var ge=function(e){var t=e.onChange,a={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0},c=Object(n.useState)(pe),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(n.useState)(k.Palettes.all[o]),j=Object(r.a)(s,2),b=j[0],d=j[1],O=Object(n.useState)(a),f=Object(r.a)(O,2),m=f[0],x=f[1];Object(n.useEffect)((function(){for(var e=[],t=0;t<16;t+=1)m[t]&&e.push(t);var a=Object(P.a)({},k.Palettes.all[o]);a.enabled=e,d(a)}),[o,m]),Object(n.useEffect)((function(){t(b)}),[b,t]);var p=Object.values(m).filter((function(e){return e})).length,g=p===b.colors.length&&o===pe;function v(e){return function(){var t=!m[e];if(t||!(p<=1)){var a=Object(P.a)({},m);a[e]=t,x(a)}}}function C(e){for(var t=[],a=e;a<e+8;a+=1){var n=Object(r.a)(b.colors[a],3),c=n[0],i=n[1],o=n[2],l="".concat(c).concat(i).concat(o);t.push(Object(W.jsxs)(ue.a,{children:[Object(W.jsx)(he.a,{children:Object(W.jsx)(K.a,{checked:m[a],onChange:v(a),name:"".concat(l,"cb")})}),Object(W.jsx)(B.a,{boxShadow:1,borderRadius:"borderRadius",children:Object(W.jsx)(me.a,{fontSize:"small",style:{color:"rgb(".concat(c,", ").concat(i,", ").concat(o,")")}})})]},l))}return t}return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(h.a,{container:!0,children:[Object(W.jsxs)(h.a,{item:!0,xs:!0,align:"left",children:[Object(W.jsx)(ce,{onClick:function(){x(a),l(pe)},disabled:g}),Object(W.jsx)(u.a,{align:"left",children:Object(W.jsx)(V,{label:"palette",value:o,items:xe,onChange:l,tooltip:"Use this palette for quantizing"})})]}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(Oe.a,{dense:!0,children:C(0)})}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(Oe.a,{dense:!0,children:C(8)})})]})})},ve=["none","bayer2x2","bayer4x4","bayer8x8"],Ce=["rgb","yuv","xyz","rainbow"],Se="bayer4x4",we=k.Palettes.all.colodore,ye="xyz",Ie=!1,Ee=!1;function ke(e){var t=e.jimpImage,a=e.filename,c=Object(n.useState)(void 0),i=Object(r.a)(c,2),o=i[0],l=i[1],s=Object(n.useState)(ye),j=Object(r.a)(s,2),b=j[0],O=j[1],f=Object(n.useState)(we),m=Object(r.a)(f,2),x=m[0],p=m[1],g=Object(n.useState)(Ie),v=Object(r.a)(g,2),C=v[0],S=v[1],w=Object(n.useState)(Ee),y=Object(r.a)(w,2),I=y[0],E=y[1],D=Object(n.useState)(Se),z=Object(r.a)(D,2),P=z[0],F=z[1],B=Object(n.useState)(32),A=Object(r.a)(B,2),M=A[0],N=A[1],T=Object(n.useCallback)((function(e){return p(e)}),[]),G="output";if(void 0!==o){var H=1===o.mode.pixelWidth?".art":".kla",q=R(a);G="".concat(q.basename.substring(0,30)).concat(H)}var J="output";void 0!==o&&(J=1===o.mode.pixelWidth?"art studio file":"koala painter file");var U=b===ye&&C===Ie&&I===Ee&&P===Se&&32===M;return Object(W.jsxs)(h.a,{container:!0,children:[Object(W.jsxs)(h.a,{item:!0,xs:!0,children:[Object(W.jsx)("h4",{children:J}),Object(W.jsx)(u.a,{children:Object(W.jsx)(de,{jimpImage:t,onChanged:function(e){l(e)},hires:C,nomaps:I,colorspaceId:b,palette:x,ditherId:P,ditherRadius:M})}),Object(W.jsx)(u.a,{children:Object(W.jsx)(L.a,{title:"Download the image as ".concat(J),arrow:!0,children:Object(W.jsx)(d.a,{variant:"contained",disabled:void 0===o,color:"primary",startIcon:Object(W.jsx)(se.a,{}),onClick:function(){return function(){var e=k.C64Writer.toBinary(o),t=k.C64Writer.toBuffer(e),a=new Blob([t],{type:"application/octet-stream"});Object(je.saveAs)(a,G)}()},children:"Download"})})}),Object(W.jsx)(ce,{onClick:function(){O(ye),S(Ie),E(Ee),F(Se),N(32)},disabled:U}),Object(W.jsxs)(u.a,{align:"left",children:[Object(W.jsx)(X,{name:"hires",label:"hires",value:C,onChange:function(e){return S(e)},tooltip:"Use high resolution mode instead of multi color"}),Object(W.jsx)(X,{name:"nomaps",label:"single color layers",value:I,onChange:function(e){return E(e)},tooltip:"Restrict each attribute layer to a single color"})]}),Object(W.jsxs)(u.a,{align:"left",children:[Object(W.jsx)(V,{label:"colorspace",value:b,items:Ce,onChange:function(e){return O(e)},tooltip:"Convert colors to this color space before quantizing"}),Object(W.jsx)(V,{label:"dithering",value:P,items:ve,onChange:function(e){return F(e)},tooltip:"Type of dithering to apply"}),Object(W.jsx)(ee,{label:"dithering strength",value:M,max:64,onChange:function(e){return N(e)},tooltip:"Strength of dithering",icon:Object(W.jsx)(re.a,{}),disabled:"none"===P})]})]}),Object(W.jsxs)(h.a,{item:!0,xs:!0,children:[Object(W.jsx)("h4",{children:"palette"}),Object(W.jsx)(ge,{onChange:T})]})]})}ke.defaultProps={jimpImage:void 0,filename:"output"};var De=ke,Re=a.p+"static/media/logo.42e2fcaf.svg",ze="2021-06-05.2e86f11",Pe="https://github.com/micheldebree/retropixels/commit/2e86f11f2ed45ba9e1109f7a0fdd1c72c83ee83e",Fe=Object(m.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var Be=function(){var e=Object(n.useState)(void 0),t=Object(r.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(void 0),o=Object(r.a)(i,2),O=o[0],m=o[1],x=Fe();return Object(W.jsx)("div",{className:"App",children:Object(W.jsxs)("body",{className:"App-body",children:[Object(W.jsx)("div",{className:x.root,children:Object(W.jsx)(l.a,{position:"static",children:Object(W.jsxs)(s.a,{variant:"dense",children:[Object(W.jsx)("img",{src:Re,alt:"Logo",className:"logo"}),Object(W.jsx)(j.a,{variant:"h6",className:x.title,align:"left",children:"Retropixels"}),Object(W.jsxs)(b.a,{href:Pe,color:"inherit",variant:"body2",children:["v",ze]}),Object(W.jsx)(d.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(W.jsx)(f.a,{})})]})})}),Object(W.jsx)(u.a,{align:"left",children:Object(W.jsxs)(j.a,{variant:"overline",children:["Convert images to ",Object(W.jsx)(b.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(W.jsxs)(h.a,{container:!0,spacing:3,children:[Object(W.jsx)(h.a,{item:!0,xs:4,children:Object(W.jsx)(ie,{onChanged:function(e){c(e.jimpImage),m(e.filename)}})}),Object(W.jsx)(h.a,{item:!0,xs:!0,children:Object(W.jsx)(De,{jimpImage:a,filename:O})})]})]})})},Ae=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,543)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),i(e),o(e)}))};o.a.render(Object(W.jsx)(c.a.StrictMode,{children:Object(W.jsx)(Be,{})}),document.getElementById("root")),Ae()}},[[499,1,2]]]);
//# sourceMappingURL=main.a32f7f00.chunk.js.map