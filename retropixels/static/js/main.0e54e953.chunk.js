(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{218:function(e,t,a){},219:function(e,t,a){},247:function(e,t){},249:function(e,t){},499:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),c=a(23),o=a.n(c),r=(a(218),a(9)),l=a(528),s=a(529),j=a(205),b=a(530),d=a(523),u=a(520),h=a(522),O=(a(219),a(202)),m=a.n(O),f=a(527),x=a(47),p=a.n(x),g=a(196),v=a.n(g),C=a(197),w=a.n(C),S=a(199),y=a.n(S),I=a(198),k=a.n(I);function E(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function D(e,t){if(e.length<=t)return e;var a=E(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}function R(e,t){if(void 0===e)return new ImageData(1,1);for(var a=e.mode.width*e.mode.pixelWidth,n=new ImageData(a,e.mode.height),i=0;i<e.mode.height;i+=1)for(var c=0;c<e.mode.width;c+=1)for(var o=e.peek(c,i),l=void 0!==o?t.colors[o]:[0,0,0,0],s=0;s<e.mode.pixelWidth;s+=1){var j=4*i*a+c*e.mode.pixelWidth*4+4*s,b=Object(r.a)(l,3),d=b[0],u=b[1],h=b[2];n.data[j]=d,n.data[j+1]=u,n.data[j+2]=h,n.data[j+3]=255}return n}var z=a(55),P=a(203),B=a(531),A=a(536),F=a(532),M=a(2);function N(e){var t=i.a.useRef(null),a=e.width,c=e.height,o=e.imageData;return Object(n.useEffect)((function(){void 0!==o&&t.current.getContext("2d").putImageData(o,0,0)}),[o]),Object(M.jsx)(B.a,{m:2,children:Object(M.jsx)("canvas",{ref:t,width:a,height:c})})}N.defaultProps={imageData:void 0};var W=N;function T(e){var t=e.onload,a=e.imageData,i=Object(n.useState)(void 0),c=Object(r.a)(i,2),o=c[0],l=c[1],s=Object(P.a)({accept:"image/*",maxFiles:1}),b=s.acceptedFiles,d=s.fileRejections,h=s.getRootProps,O=s.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){p.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b,t]),Object(n.useEffect)((function(){if(void 0!==d&&d.length>0){var e=d[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[d]),Object(M.jsxs)(u.a,{children:[Object(M.jsx)(B.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(M.jsxs)("div",Object(z.a)(Object(z.a)({},h({className:"dropzone"})),{},{children:[Object(M.jsx)("input",Object(z.a)({},O())),Object(M.jsx)(W,{width:320,height:200,imageData:a}),Object(M.jsx)(j.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(M.jsx)(A.a,{open:o,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(M.jsx)(F.a,{severity:"error",children:o})})]})}T.defaultProps={imageData:void 0};var G=T,H=a(537),L=a(538),_=a(539),J=a(540),U=a(521),q=a(533);function Q(e){var t=e.label,a=e.value,n=e.items,i=e.onChange,c=e.tooltip;return Object(M.jsx)(H.a,{title:c,children:Object(M.jsxs)(L.a,{component:"fieldset",children:[Object(M.jsx)(_.a,{component:"legend",children:t}),Object(M.jsx)(J.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return i(e.target.value)},children:n.map((function(e){return Object(M.jsx)(U.a,{value:e,control:Object(M.jsx)(q.a,{}),label:e},e)}))})]})})}Q.defaultProps={label:"Choose"};var Z=Q,V=a(535);var K=function(e){var t=e.name,a=e.label,n=e.value,i=e.onChange,c=e.tooltip;return Object(M.jsx)(H.a,{title:c,arrow:!0,children:Object(M.jsx)(U.a,{control:Object(M.jsx)(V.a,{checked:n,onChange:function(e){return i(e.target.checked)},name:"".concat(t,"Checkbox")}),label:a})})},X=a(541);function Y(e){var t=e.label,a=e.value,n=e.min,i=e.max,c=e.step,o=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(_.a,{component:"legend",children:t}),Object(M.jsx)(H.a,{title:r,arrow:!0,children:Object(M.jsxs)(h.a,{container:!0,children:[Object(M.jsxs)(h.a,{item:!0,children:[l," \xa0"]}),Object(M.jsx)(h.a,{item:!0,xs:!0,children:Object(M.jsx)(X.a,{min:n,max:i,step:c,value:a,onChange:function(e,t){return o(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}Y.defaultProps={min:0,step:1,disabled:!1};var $=Y,ee=a(195),te=a.n(ee);function ae(e){var t=e.onClick,a=e.disabled;return Object(M.jsx)(B.a,{align:"left",m:2,children:Object(M.jsx)(H.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(M.jsx)(d.a,{size:"small",variant:"outlined",disabled:a,startIcon:Object(M.jsx)(te.a,{}),onClick:t,children:"defaults"})})})}ae.defaultProps={disabled:!1};var ne=ae,ie=!0,ce=!1,oe=!1,re=!1,le=!1;var se=function(e){var t=e.onChanged,a=Object(n.useState)(void 0),i=Object(r.a)(a,2),c=i[0],o=i[1],l=Object(n.useState)(void 0),s=Object(r.a)(l,2),j=s[0],b=s[1],d=Object(n.useState)(void 0),h=Object(r.a)(d,2),O=h[0],m=h[1],f=Object(n.useState)(void 0),p=Object(r.a)(f,2),g=p[0],C=p[1],S=Object(n.useState)("input"),I=Object(r.a)(S,2),E=I[0],R=I[1],z=Object(n.useState)("fill"),P=Object(r.a)(z,2),B=P[0],A=P[1],F=Object(n.useState)(ie),N=Object(r.a)(F,2),W=N[0],T=N[1],H=Object(n.useState)(ce),L=Object(r.a)(H,2),_=L[0],J=L[1],U=Object(n.useState)(oe),q=Object(r.a)(U,2),Q=q[0],V=q[1],X=Object(n.useState)(re),Y=Object(r.a)(X,2),ee=Y[0],te=Y[1],ae=Object(n.useState)(le),se=Object(r.a)(ae,2),je=se[0],be=se[1],de=Object(n.useState)(0),ue=Object(r.a)(de,2),he=ue[0],Oe=ue[1],me=Object(n.useState)(0),fe=Object(r.a)(me,2),xe=fe[0],pe=fe[1],ge=Object(n.useState)(0),ve=Object(r.a)(ge,2),Ce=ve[0],we=ve[1],Se=Object(n.useState)(0),ye=Object(r.a)(Se,2),Ie=ye[0],ke=ye[1],Ee=Object(n.useCallback)((function(e){o(e.jimpImage),R(e.filename)}),[]);Object(n.useEffect)((function(){void 0!==O&&(t({jimpImage:O,filename:E}),C(function(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,void 0!==e?new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height):void 0}}(O)))}),[O,t,E]),Object(n.useEffect)((function(){void 0!==c&&b(function(e,t){var a=e.clone();return"fill"===t?a.cover(320,200,x.RESIZE_HERMITE):"fit"===t?a.contain(320,200,x.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(a),a}(c,B))}),[c,B]),Object(n.useEffect)((function(){if(void 0!==j){var e=j.clone();_&&e.greyscale(),W&&e.normalize(),e.brightness(he),e.contrast(xe),Ce>0&&e.blur(Ce),e.mirror(Q,ee),je&&e.invert(),Ie>0&&e.threshold({max:Ie,autoGreyscale:!1}),m(e)}}),[j,W,he,xe,_,Ce,Q,ee,je,Ie]);var De=W===ie&&_===ce&&Q===oe&&ee===re&&je===le&&0===xe&&0===he&&0===Ce&&0===Ie;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("h4",{children:D(E,30)}),Object(M.jsx)(u.a,{children:Object(M.jsx)(G,{imageData:g,onload:Ee})}),Object(M.jsx)(u.a,{align:"left",children:Object(M.jsx)(Z,{label:"cropping",items:["crop","fill","fit"],value:B,onChange:A,tooltip:"Type of cropping to apply to source image"})}),Object(M.jsx)(ne,{onClick:function(){T(ie),J(ce),V(oe),te(re),be(le),Oe(0),pe(0),we(0),ke(0)},disabled:De}),Object(M.jsxs)(u.a,{align:"left",children:[Object(M.jsx)(K,{name:"normalize",label:"normalize",value:W,onChange:T,tooltip:"Stretch color intensities to their full range"}),Object(M.jsx)(K,{name:"greyscale",label:"greyscale",value:_,onChange:J,tooltip:"Convert to black and white"}),Object(M.jsx)(K,{name:"invert",label:"invert",value:je,onChange:function(e){return be(e)},tooltip:"Invert colors"}),Object(M.jsx)(K,{name:"mirrorHor",label:"flip horizontal",value:Q,onChange:V,tooltip:"Mirror image horizontally"}),Object(M.jsx)(K,{name:"mirrorVer",label:"flip vertical",value:ee,onChange:te,tooltip:"Mirror image vertically"}),Object(M.jsx)($,{label:"brightness",value:he,min:-1,max:1,step:.05,onChange:Oe,tooltip:"Adjust image brightness",icon:Object(M.jsx)(v.a,{})}),Object(M.jsx)($,{label:"contrast",value:xe,min:-1,max:1,step:.05,onChange:pe,tooltip:"Adjust image contrast",icon:Object(M.jsx)(w.a,{})}),Object(M.jsx)($,{label:"blur",value:Ce,max:10,onChange:we,tooltip:"Blur image by this many pixels",icon:Object(M.jsx)(k.a,{})}),Object(M.jsx)($,{label:"threshold",value:Ie,max:255,onChange:ke,tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(M.jsx)(y.a,{})})]})]})},je=a(201),be=a.n(je),de=a(111),ue=a.n(de),he=a(21),Oe=a(110),me=he.GraphicModes.all.bitmap;function fe(e){var t=e.jimpImage,a=e.onChanged,i=e.hires,c=e.nomaps,o=e.colorspaceId,l=e.palette,s=e.ditherId,j=e.ditherRadius,b=new he.Quantizer(l,he.ColorSpaces.all[o]),d=new he.Converter(b),u=new he.OrderedDither(he.OrderedDither.presets[s],j),h=Object(n.useState)(void 0),O=Object(r.a)(h,2),m=O[0],f=O[1],x=Object(n.useState)(void 0),p=Object(r.a)(x,2),g=p[0],v=p[1],C=Object(n.useState)(d),w=Object(r.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(u),k=Object(r.a)(I,2),E=k[0],D=k[1];return Object(n.useEffect)((function(){var e=new he.Quantizer(l,he.ColorSpaces.all[o]);y(new he.Converter(e))}),[o,l]),Object(n.useEffect)((function(){D(new he.OrderedDither(he.OrderedDither.presets[s],j))}),[s,j]),Object(n.useEffect)((function(){if(void 0!==t){var e=me({hires:i,nomaps:c}),a=function(e,t){var a=e.clone();return a.resize(t.mode.width,t.mode.height),a}(t,e);E.dither(a.bitmap),f(e),S.convert(a.bitmap,e),f(e)}}),[t,i,c,S,E]),Object(n.useEffect)((function(){v(R(m,l)),a(m)}),[m,a,l]),Object(M.jsx)(W,{width:320,height:200,imageData:g})}fe.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",palette:he.Palettes.all.colodore,ditherId:"bayer4x4",ditherRadius:32};var xe=fe,pe=a(524),ge=a(525),ve=a(526),Ce=a(200),we=a.n(Ce),Se=["colodore","pepto"],ye="colodore";var Ie=function(e){var t=e.onChange,a={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0},i=Object(n.useState)(ye),c=Object(r.a)(i,2),o=c[0],l=c[1],s=Object(n.useState)(he.Palettes.all[o]),j=Object(r.a)(s,2),b=j[0],d=j[1],O=Object(n.useState)(a),m=Object(r.a)(O,2),f=m[0],x=m[1],p=Object(n.useMemo)((function(){return Object.keys(f).filter((function(e){return f[e]}))}),[f]);Object(n.useEffect)((function(){var e=Object(z.a)({},he.Palettes.all[o]);e.enabled=p,d(e)}),[o,p]),Object(n.useEffect)((function(){t(b)}),[b,t]);var g=p.length===b.colors.length&&o===ye;function v(e){return function(){var t=!f[e];if(t||!(p.length<=1)){var a=Object(z.a)({},f);a[e]=t,x(a)}}}function C(e){for(var t=[],a=e;a<e+8;a+=1){var n=Object(r.a)(b.colors[a],3),i=n[0],c=n[1],o=n[2],l="".concat(i).concat(c).concat(o);t.push(Object(M.jsxs)(pe.a,{children:[Object(M.jsx)(ge.a,{children:Object(M.jsx)(V.a,{checked:f[a],onChange:v(a),name:"".concat(l,"cb")})}),Object(M.jsx)(B.a,{boxShadow:1,borderRadius:"borderRadius",children:Object(M.jsx)(we.a,{fontSize:"small",style:{color:"rgb(".concat(i,", ").concat(c,", ").concat(o,")")}})})]},l))}return t}return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(h.a,{container:!0,children:[Object(M.jsxs)(h.a,{item:!0,xs:12,align:"left",children:[Object(M.jsx)(ne,{onClick:function(){x(a),l(ye)},disabled:g}),Object(M.jsx)(u.a,{align:"left",children:Object(M.jsx)(Z,{label:"palette",value:o,items:Se,onChange:l,tooltip:"Use this palette for quantizing"})})]}),Object(M.jsx)(h.a,{item:!0,xs:6,children:Object(M.jsx)(ve.a,{dense:!0,children:C(0)})}),Object(M.jsx)(h.a,{item:!0,xs:6,children:Object(M.jsx)(ve.a,{dense:!0,children:C(8)})})]})})},ke=["none","bayer2x2","bayer4x4","bayer8x8"],Ee=["rgb","yuv","xyz","rainbow"],De="bayer4x4",Re=he.Palettes.all.colodore,ze="xyz",Pe=!1,Be=!1,Ae=Object(f.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function Fe(e){var t,a=e.jimpImage,i=e.filename,c=Object(n.useState)(void 0),o=Object(r.a)(c,2),l=o[0],s=o[1],j=Object(n.useState)(ze),b=Object(r.a)(j,2),O=b[0],m=b[1],f=Object(n.useState)(Re),x=Object(r.a)(f,2),g=x[0],v=x[1],C=Object(n.useState)(Pe),w=Object(r.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(Be),k=Object(r.a)(I,2),D=k[0],z=k[1],P=Object(n.useState)(De),B=Object(r.a)(P,2),A=B[0],F=B[1],N=Object(n.useState)(32),W=Object(r.a)(N,2),T=W[0],G=W[1],L=Object(n.useCallback)((function(e){return v(e)}),[]),_=Object(n.useCallback)((function(e){return s(e)}),[]),J="output";if(void 0!==l){var U=function(e){return 1===e.mode.pixelWidth?".art":".kla"}(l),q=E(i);J="".concat(q.basename).concat(U),t="".concat(q.basename,".png")}var Q="output";void 0!==l&&(Q=1===l.mode.pixelWidth?"art studio":"koala painter");var V=O===ze&&S===Pe&&D===Be&&A===De&&32===T,X=Ae();return Object(M.jsxs)(h.a,{container:!0,children:[Object(M.jsxs)(h.a,{item:!0,xs:12,sm:12,md:6,children:[Object(M.jsx)("h4",{children:J}),Object(M.jsx)(u.a,{children:Object(M.jsx)(xe,{jimpImage:a,onChanged:_,hires:S,nomaps:D,colorspaceId:O,palette:g,ditherId:A,ditherRadius:T})}),Object(M.jsxs)(u.a,{align:"left",className:X.root,children:[Object(M.jsx)(H.a,{title:"Download the image as ".concat(Q," file"),arrow:!0,children:Object(M.jsx)(d.a,{variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(M.jsx)(ue.a,{}),onClick:function(){return function(e,t){var a=he.C64Writer.toBinary(e),n=he.C64Writer.toBuffer(a),i=new Blob([n],{type:"application/octet-stream"});Object(Oe.saveAs)(i,t)}(l,J)},children:Q})}),Object(M.jsx)(H.a,{title:"Download the image",arrow:!0,children:Object(M.jsx)(d.a,{variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(M.jsx)(ue.a,{}),onClick:function(){return function(e,t,a){var n=e.mode.width*e.mode.pixelWidth,i=e.mode.height;new p.a(n,i,(function(n,i){if(n)throw n;var c=R(e,t);i.bitmap.width=c.width,i.bitmap.height=c.height,i.bitmap.data=c.data,i.getBufferAsync(p.a.MIME_PNG).then((function(e){var t=new Blob([e],{type:"application/octet-stream"});Object(Oe.saveAs)(t,a)}))}))}(l,g,t)},children:"Image"})})]}),Object(M.jsx)(ne,{onClick:function(){m(ze),y(Pe),z(Be),F(De),G(32)},disabled:V}),Object(M.jsxs)(u.a,{align:"left",children:[Object(M.jsx)(K,{name:"hires",label:"hires",value:S,onChange:y,tooltip:"Use high resolution mode instead of multi color"}),Object(M.jsx)(K,{name:"nomaps",label:"single color layers",value:D,onChange:z,tooltip:"Restrict each attribute layer to a single color"})]}),Object(M.jsxs)(u.a,{align:"left",children:[Object(M.jsx)(Z,{label:"colorspace",value:O,items:Ee,onChange:m,tooltip:"Convert colors to this color space before quantizing"}),Object(M.jsx)(Z,{label:"dithering",value:A,items:ke,onChange:F,tooltip:"Type of dithering to apply"}),Object(M.jsx)($,{label:"dithering strength",value:T,max:64,onChange:G,tooltip:"Strength of dithering",icon:Object(M.jsx)(be.a,{}),disabled:"none"===A})]})]}),Object(M.jsxs)(h.a,{item:!0,xs:!0,children:[Object(M.jsx)("h4",{children:"palette"}),Object(M.jsx)(Ie,{onChange:L})]})]})}Fe.defaultProps={jimpImage:void 0,filename:"output"};var Me=Fe,Ne=a.p+"static/media/logo.42e2fcaf.svg",We="2021-06-14.c1fe254",Te="https://github.com/micheldebree/retropixels/commit/c1fe25421072a32d9da9608a891dfa9d0990003f",Ge=Object(f.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var He=function(){var e=Object(n.useState)(void 0),t=Object(r.a)(e,2),a=t[0],i=t[1],c=Object(n.useState)(void 0),o=Object(r.a)(c,2),O=o[0],f=o[1],x=Ge();return Object(M.jsx)("div",{className:"App",children:Object(M.jsxs)("body",{className:"App-body",children:[Object(M.jsx)("div",{className:x.root,children:Object(M.jsx)(l.a,{position:"static",children:Object(M.jsxs)(s.a,{variant:"dense",children:[Object(M.jsx)("img",{src:Ne,alt:"Logo",className:"logo"}),Object(M.jsx)(j.a,{variant:"h6",className:x.title,align:"left",children:"Retropixels"}),Object(M.jsxs)(b.a,{href:Te,color:"inherit",variant:"body2",children:["v",We]}),Object(M.jsx)(d.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(M.jsx)(m.a,{})})]})})}),Object(M.jsx)(u.a,{align:"left",children:Object(M.jsxs)(j.a,{variant:"overline",children:["Convert images to ",Object(M.jsx)(b.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(M.jsxs)(h.a,{container:!0,spacing:3,children:[Object(M.jsx)(h.a,{item:!0,xs:12,sm:6,md:4,children:Object(M.jsx)(se,{onChanged:function(e){i(e.jimpImage),f(e.filename)}})}),Object(M.jsx)(h.a,{item:!0,xs:12,sm:6,md:8,children:Object(M.jsx)(Me,{jimpImage:a,filename:O})})]})]})})},Le=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,543)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),n(e),i(e),c(e),o(e)}))};o.a.render(Object(M.jsx)(i.a.StrictMode,{children:Object(M.jsx)(He,{})}),document.getElementById("root")),Le()}},[[499,1,2]]]);
//# sourceMappingURL=main.0e54e953.chunk.js.map