(this["webpackJsonpretropixels-web"]=this["webpackJsonpretropixels-web"]||[]).push([[0],{247:function(e,t,a){},248:function(e,t,a){},269:function(e,t){},271:function(e,t){},509:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(213),o=(a(247),a(8)),r=a(584),l=a(585),s=a(578),j=a(586),b=a(576),d=a(572),u=a(575),h=(a(248),a(229)),O=a.n(h),m=a(563),f=a(230),p=a(587),x=a(58),g=a.n(x),v=a(221),C=a.n(v),w=a(222),S=a.n(w),y=a(225),I=a.n(y),k=a(224),E=a.n(k),D=a(223),R=a.n(D);function P(e){var t=e.lastIndexOf("."),a=e.substring(t+1,e.length);return{basename:e.substring(0,Math.min(30,t)),extension:a}}function z(e,t){if(e.length<=t)return e;var a=P(e);return"".concat(a.basename.substring(0,t),"...").concat(a.extension)}function A(e,t){if(void 0===e)return new ImageData(1,1);for(var a=e.mode.width*e.mode.pixelWidth,n=new ImageData(a,e.mode.height),c=0;c<e.mode.height;c+=1)for(var i=0;i<e.mode.width;i+=1)for(var r=e.peek(i,c),l=void 0!==r?t.colors[r]:[0,0,0,0],s=0;s<e.mode.pixelWidth;s+=1){var j=4*c*a+i*e.mode.pixelWidth*4+4*s,b=Object(o.a)(l,3),d=b[0],u=b[1],h=b[2];n.data[j]=d,n.data[j+1]=u,n.data[j+2]=h,n.data[j+3]=255}return n}var B=a(66),M=a(231),F=a(577),W=a(568),N=a(564),L=a(1);function T(e){var t=c.a.useRef(null),a=e.width,i=e.height,o=e.imageData;return Object(n.useEffect)((function(){void 0!==o&&t.current.getContext("2d").putImageData(o,0,0)}),[o]),Object(L.jsx)(F.a,{m:2,children:Object(L.jsx)("canvas",{ref:t,width:a,height:i})})}T.defaultProps={imageData:void 0};var G=T;function H(e){var t=e.onload,a=e.imageData,c=Object(n.useState)(void 0),i=Object(o.a)(c,2),r=i[0],l=i[1],j=Object(M.a)({accept:"image/*",maxFiles:1}),b=j.acceptedFiles,u=j.fileRejections,h=j.getRootProps,O=j.getInputProps;return Object(n.useEffect)((function(){void 0!==b&&1===b.length&&function(e){var a=new FileReader;a.onabort=function(){return l("file reading was aborted")},a.onerror=function(){return l("file reading has failed")},a.onload=function(){g.a.read(a.result).then((function(a){l(void 0),t({jimpImage:a,filename:e.name})})).catch((function(e){l(e.message)}))},a.readAsArrayBuffer(e)}(b[0])}),[b,t]),Object(n.useEffect)((function(){if(void 0!==u&&u.length>0){var e=u[0],t=e.errors.map((function(e){return e.message})).reduce((function(e,t){return"".concat(e,",").concat(t)}));l("Cannot load ".concat(e.file.path,": ").concat(t))}}),[u]),Object(L.jsxs)(d.a,{children:[Object(L.jsx)(F.a,{border:0,m:1,boxShadow:2,borderRadius:"borderRadius",borderColor:"textSecondary",children:Object(L.jsxs)("div",Object(B.a)(Object(B.a)({},h({className:"dropzone"})),{},{children:[Object(L.jsx)("input",Object(B.a)({},O())),Object(L.jsx)(G,{width:320,height:200,imageData:a}),Object(L.jsx)(s.a,{color:"textSecondary",gutterBottom:!0,children:"Drop image here, or click to browse"})]}))}),Object(L.jsx)(W.a,{open:r,autoHideDuration:6e3,onClose:function(){return l(void 0)},children:Object(L.jsx)(N.a,{severity:"error",children:r})})]})}H.defaultProps={imageData:void 0};var _=H,J=a(562),U=a(573),q=a(580),Q=a(574),Z=a(581),V=a(567);function K(e){var t=e.label,a=e.value,n=e.items,c=e.onChange,i=e.tooltip;return Object(L.jsx)(J.a,{title:i,children:Object(L.jsxs)(U.a,{component:"fieldset",children:[Object(L.jsx)(q.a,{component:"legend",children:t}),Object(L.jsx)(Q.a,{row:!0,"aria-label":t,name:"select".concat(t),value:a,onChange:function(e){return c(e.target.value)},children:n.map((function(e){return Object(L.jsx)(Z.a,{value:e,control:Object(L.jsx)(V.a,{}),label:e},e)}))})]})})}K.defaultProps={label:"Choose"};var X=K,Y=a(569);var $=function(e){var t=e.name,a=e.label,n=e.value,c=e.onChange,i=e.tooltip;return Object(L.jsx)(J.a,{title:i,arrow:!0,children:Object(L.jsx)(Z.a,{control:Object(L.jsx)(Y.a,{checked:n,onChange:function(e){return c(e.target.checked)},name:"".concat(t,"Checkbox")}),label:a})})},ee=a(566);function te(e){var t=e.label,a=e.value,n=e.min,c=e.max,i=e.step,o=e.onChange,r=e.tooltip,l=e.icon,s=e.disabled;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(q.a,{component:"legend",children:t}),Object(L.jsx)(J.a,{title:r,arrow:!0,children:Object(L.jsxs)(u.a,{container:!0,children:[Object(L.jsxs)(u.a,{item:!0,children:[l," \xa0"]}),Object(L.jsx)(u.a,{item:!0,xs:!0,children:Object(L.jsx)(ee.a,{min:n,max:c,step:i,value:a,onChange:function(e,t){return o(t)},valueLabelDisplay:"auto",disabled:s})})]})})]})}te.defaultProps={min:0,step:1,disabled:!1};var ae=te,ne=a(220),ce=a.n(ne);function ie(e){var t=e.onClick,a=e.disabled;return Object(L.jsx)(F.a,{align:"left",m:2,children:Object(L.jsx)(J.a,{title:"Reset controls below to their default settings",arrow:!0,children:Object(L.jsx)(b.a,{size:"small",variant:"outlined",disabled:a,startIcon:Object(L.jsx)(ce.a,{}),onClick:t,children:"defaults"})})})}ie.defaultProps={disabled:!1};var oe=ie,re=!1,le=!1,se=!1;var je=function(e){var t=e.onChanged,a=Object(n.useState)(void 0),c=Object(o.a)(a,2),i=c[0],r=c[1],l=Object(n.useState)(void 0),s=Object(o.a)(l,2),j=s[0],b=s[1],u=Object(n.useState)(void 0),h=Object(o.a)(u,2),O=h[0],m=h[1],f=Object(n.useState)(void 0),p=Object(o.a)(f,2),g=p[0],v=p[1],w=Object(n.useState)("input"),y=Object(o.a)(w,2),k=y[0],D=y[1],P=Object(n.useState)("fill"),A=Object(o.a)(P,2),B=A[0],M=A[1],F=Object(n.useState)(true),W=Object(o.a)(F,2),N=W[0],T=W[1],G=Object(n.useState)(re),H=Object(o.a)(G,2),J=H[0],U=H[1],q=Object(n.useState)(le),Q=Object(o.a)(q,2),Z=Q[0],V=Q[1],K=Object(n.useState)(se),Y=Object(o.a)(K,2),ee=Y[0],te=Y[1],ne=Object(n.useState)(0),ce=Object(o.a)(ne,2),ie=ce[0],je=ce[1],be=Object(n.useState)(0),de=Object(o.a)(be,2),ue=de[0],he=de[1],Oe=Object(n.useState)(0),me=Object(o.a)(Oe,2),fe=me[0],pe=me[1],xe=Object(n.useState)(0),ge=Object(o.a)(xe,2),ve=ge[0],Ce=ge[1],we=Object(n.useState)(0),Se=Object(o.a)(we,2),ye=Se[0],Ie=Se[1],ke=Object(n.useCallback)((function(e){r(e.jimpImage),D(e.filename)}),[]),Ee=Object(n.useCallback)((function(){T(true),U(re),V(le),te(se),je(0),he(0),pe(0),Ce(0),Ie(0)}),[]);Object(n.useEffect)((function(){void 0!==O&&(t({jimpImage:O,filename:k}),v(function(e){if(void 0!==e){var t,a=e.bitmap.width*e.bitmap.height*4;return t=e.bitmap.data.length>a?e.bitmap.data.slice(0,a):e.bitmap.data,new ImageData(Uint8ClampedArray.from(t),e.bitmap.width,e.bitmap.height)}}(O)))}),[O,t,k]),Object(n.useEffect)((function(){void 0!==i&&b(function(e,t){var a=e.clone();return"fill"===t?a.cover(320,200,x.RESIZE_HERMITE):"fit"===t?a.contain(320,200,x.RESIZE_HERMITE):function(e){var t;(e.bitmap.width<320||e.bitmap.height<200)&&(t=e.clone()),e.crop(0,0,320,200),void 0!==t&&(this.clearJimpImage(e),e.blit(t,0,0))}(a),a}(i,B))}),[i,B]),Object(n.useEffect)((function(){if(void 0!==j){var e=j.clone();N&&e.normalize(),e.brightness(ie),e.contrast(ue),fe>0&&e.blur(fe),e.mirror(J,Z),ee&&e.invert(),ve>0&&e.threshold({max:ve,autoGreyscale:!1}),ye>0?e.color([{apply:"saturate",params:[ye]}]):ye<0&&e.color([{apply:"desaturate",params:[-ye]}]),m(e)}}),[j,N,ie,ue,fe,J,Z,ee,ve,ye]);var De=J===re&&Z===le&&ee===se&&0===ue&&0===ie&&0===fe&&0===ve&&0===ye;return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)("h4",{children:z(k,30)}),Object(L.jsx)(d.a,{children:Object(L.jsx)(_,{imageData:g,onload:ke})}),Object(L.jsx)(d.a,{align:"left",children:Object(L.jsx)(X,{label:"cropping",items:["crop","fill","fit"],value:B,onChange:M,tooltip:"Type of cropping to apply to source image"})}),Object(L.jsx)(oe,{onClick:Ee,disabled:De}),Object(L.jsxs)(d.a,{align:"left",children:[Object(L.jsx)($,{name:"normalize",label:"normalize",value:N,onChange:T,tooltip:"Stretch color intensities to their full range"}),Object(L.jsx)($,{name:"invert",label:"invert",value:ee,onChange:function(e){return te(e)},tooltip:"Invert colors"}),Object(L.jsx)($,{name:"mirrorHor",label:"flip horizontal",value:J,onChange:U,tooltip:"Mirror image horizontally"}),Object(L.jsx)($,{name:"mirrorVer",label:"flip vertical",value:Z,onChange:V,tooltip:"Mirror image vertically"}),Object(L.jsx)(ae,{label:"brightness",value:ie,min:-1,max:1,step:.05,onChange:je,tooltip:"Adjust image brightness",icon:Object(L.jsx)(C.a,{})}),Object(L.jsx)(ae,{label:"contrast",value:ue,min:-1,max:1,step:.05,onChange:he,tooltip:"Adjust image contrast",icon:Object(L.jsx)(S.a,{})}),Object(L.jsx)(ae,{label:"saturation",value:ye,min:-100,max:100,onChange:Ie,tooltip:"Adjust color saturation",icon:Object(L.jsx)(R.a,{})}),Object(L.jsx)(ae,{label:"blur",value:fe,max:10,onChange:pe,tooltip:"Blur image by this many pixels",icon:Object(L.jsx)(E.a,{})}),Object(L.jsx)(ae,{label:"threshold",value:ve,max:255,onChange:Ce,tooltip:"Convert to black and white and remove pixels below this intensity threshold. (0 = off)",icon:Object(L.jsx)(I.a,{})})]})]})},be=a(228),de=a.n(be),ue=a(138),he=a.n(ue),Oe=a(31),me=a(137),fe=Oe.GraphicModes.all.bitmap;function pe(e){var t=e.jimpImage,a=e.onChanged,c=e.hires,i=e.nomaps,r=e.colorspaceId,l=e.palette,s=e.ditherId,j=e.ditherRadius,b=new Oe.Quantizer(l,Oe.ColorSpaces.all[r]),d=new Oe.Converter(b),u=new Oe.OrderedDither(Oe.OrderedDither.presets[s],j),h=Object(n.useState)(void 0),O=Object(o.a)(h,2),m=O[0],f=O[1],p=Object(n.useState)(void 0),x=Object(o.a)(p,2),g=x[0],v=x[1],C=Object(n.useState)(d),w=Object(o.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(u),k=Object(o.a)(I,2),E=k[0],D=k[1];return Object(n.useEffect)((function(){var e=new Oe.Quantizer(l,Oe.ColorSpaces.all[r]);y(new Oe.Converter(e))}),[r,l]),Object(n.useEffect)((function(){D(new Oe.OrderedDither(Oe.OrderedDither.presets[s],j))}),[s,j]),Object(n.useEffect)((function(){if(void 0!==t){var e=fe({hires:c,nomaps:i}),a=function(e,t){var a=e.clone();return a.resize(t.mode.width,t.mode.height),a}(t,e);E.dither(a.bitmap),f(e),S.convert(a.bitmap,e),f(e)}}),[t,c,i,S,E]),Object(n.useEffect)((function(){v(A(m,l)),a(m)}),[m,a,l]),Object(L.jsx)(G,{width:320,height:200,imageData:g})}pe.defaultProps={jimpImage:void 0,onChanged:function(){},hires:!1,nomaps:!1,colorspaceId:"xyz",palette:Oe.Palettes.all.colodore,ditherId:"bayer4x4",ditherRadius:32};var xe=pe,ge=a(570),ve=a(582),Ce=a(583),we=a(226),Se=a.n(we),ye=["PALette","colodore","pepto"],Ie="PALette",ke={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0};var Ee=function(e){var t=e.onChange,a=Object(n.useState)(Ie),c=Object(o.a)(a,2),i=c[0],r=c[1],l=Object(n.useState)(Oe.Palettes.all[i]),s=Object(o.a)(l,2),j=s[0],b=s[1],h=Object(n.useState)(ke),O=Object(o.a)(h,2),m=O[0],f=O[1],p=Object(n.useMemo)((function(){return Object.keys(m).filter((function(e){return m[e]}))}),[m]);Object(n.useEffect)((function(){var e=Object(B.a)({},Oe.Palettes.all[i]);e.enabled=p,b(e)}),[i,p]),Object(n.useEffect)((function(){t(j)}),[j,t]);var x=p.length===j.colors.length&&i===Ie,g=Object(n.useCallback)((function(){f(ke),r(Ie)}),[]);function v(e){return function(){var t=!m[e];if(t||!(p.length<=1)){var a=Object(B.a)({},m);a[e]=t,f(a)}}}function C(e){for(var t=[],a=e;a<e+8;a+=1){var n=Object(o.a)(j.colors[a],3),c=n[0],i=n[1],r=n[2],l="".concat(c).concat(i).concat(r);t.push(Object(L.jsxs)(ge.a,{children:[Object(L.jsx)(ve.a,{children:Object(L.jsx)(Y.a,{checked:m[a],onChange:v(a),name:"".concat(l,"cb")})}),Object(L.jsx)(F.a,{boxShadow:1,borderRadius:"borderRadius",children:Object(L.jsx)(Se.a,{fontSize:"small",style:{color:"rgb(".concat(c,", ").concat(i,", ").concat(r,")")}})})]},l))}return t}return Object(L.jsxs)(u.a,{container:!0,children:[Object(L.jsxs)(u.a,{item:!0,xs:12,align:"left",children:[Object(L.jsx)(oe,{onClick:g,disabled:x}),Object(L.jsx)(d.a,{align:"left",children:Object(L.jsx)(X,{label:"palette",value:i,items:ye,onChange:r,tooltip:"Use this palette for quantizing"})})]}),Object(L.jsx)(u.a,{item:!0,xs:6,children:Object(L.jsx)(Ce.a,{dense:!0,children:C(0)})}),Object(L.jsx)(u.a,{item:!0,xs:6,children:Object(L.jsx)(Ce.a,{dense:!0,children:C(8)})})]})},De=["none","bayer2x2","bayer4x4","bayer8x8"],Re=["rgb","yuv","xyz","rainbow"],Pe="bayer2x2",ze=Oe.Palettes.all.colodore,Ae="yuv",Be=!1,Me=!1,Fe=Object(m.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function We(e){var t,a=e.jimpImage,c=e.filename,i=Object(n.useState)(void 0),r=Object(o.a)(i,2),l=r[0],s=r[1],j=Object(n.useState)(Ae),h=Object(o.a)(j,2),O=h[0],m=h[1],f=Object(n.useState)(ze),p=Object(o.a)(f,2),x=p[0],v=p[1],C=Object(n.useState)(Be),w=Object(o.a)(C,2),S=w[0],y=w[1],I=Object(n.useState)(Me),k=Object(o.a)(I,2),E=k[0],D=k[1],R=Object(n.useState)(Pe),z=Object(o.a)(R,2),B=z[0],M=z[1],F=Object(n.useState)(32),W=Object(o.a)(F,2),N=W[0],T=W[1],G=Object(n.useCallback)((function(e){return v(e)}),[]),H=Object(n.useCallback)((function(e){return s(e)}),[]),_="output";if(void 0!==l){var U=function(e){return 1===e.mode.pixelWidth?".art":".kla"}(l),q=P(c);_="".concat(q.basename).concat(U),t="".concat(q.basename,".png")}var Q=Object(n.useCallback)((function(){m(Ae),y(Be),D(Me),M(Pe),T(32)}),[]),Z="output";void 0!==l&&(Z=1===l.mode.pixelWidth?"art studio":"koala painter");var V=O===Ae&&S===Be&&E===Me&&B===Pe&&32===N,K=Fe();return Object(L.jsxs)(u.a,{container:!0,children:[Object(L.jsxs)(u.a,{item:!0,xs:12,sm:12,md:6,children:[Object(L.jsx)("h4",{children:_}),Object(L.jsx)(d.a,{children:Object(L.jsx)(xe,{jimpImage:a,onChanged:H,hires:S,nomaps:E,colorspaceId:O,palette:x,ditherId:B,ditherRadius:N})}),Object(L.jsxs)(d.a,{align:"left",className:K.root,children:[Object(L.jsx)(J.a,{title:"Download the image as ".concat(Z," file"),arrow:!0,children:Object(L.jsx)(b.a,{sx:{marginRight:"2em"},variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(L.jsx)(he.a,{}),onClick:function(){return function(e,t){var a=Oe.C64Writer.toBinary(e),n=Oe.C64Writer.toBuffer(a),c=new Blob([n],{type:"application/octet-stream"});Object(me.saveAs)(c,t)}(l,_)},children:Z})}),Object(L.jsx)(J.a,{title:"Download the image",arrow:!0,children:Object(L.jsx)(b.a,{variant:"contained",disabled:void 0===l,color:"primary",startIcon:Object(L.jsx)(he.a,{}),onClick:function(){return function(e,t,a){var n=e.mode.width*e.mode.pixelWidth,c=e.mode.height;new g.a(n,c,(function(n,c){if(n)throw n;var i=A(e,t);c.bitmap.width=i.width,c.bitmap.height=i.height,c.bitmap.data=i.data,c.getBufferAsync(g.a.MIME_PNG).then((function(e){var t=new Blob([e],{type:"application/octet-stream"});Object(me.saveAs)(t,a)}))}))}(l,x,t)},children:"Image"})})]}),Object(L.jsx)(oe,{onClick:Q,disabled:V}),Object(L.jsxs)(d.a,{align:"left",children:[Object(L.jsx)($,{name:"hires",label:"hires",value:S,onChange:y,tooltip:"Use high resolution mode instead of multi color"}),Object(L.jsx)($,{name:"nomaps",label:"single color layers",value:E,onChange:D,tooltip:"Restrict each attribute layer to a single color"})]}),Object(L.jsxs)(d.a,{align:"left",children:[Object(L.jsx)(X,{label:"colorspace",value:O,items:Re,onChange:m,tooltip:"Convert colors to this color space before quantizing"}),Object(L.jsx)(X,{label:"dithering",value:B,items:De,onChange:M,tooltip:"Type of dithering to apply"}),Object(L.jsx)(ae,{label:"dithering strength",value:N,max:64,onChange:T,tooltip:"Strength of dithering",icon:Object(L.jsx)(de.a,{}),disabled:"none"===B})]})]}),Object(L.jsxs)(u.a,{item:!0,xs:!0,children:[Object(L.jsx)("h4",{children:"palette"}),Object(L.jsx)(Ee,{onChange:G})]})]})}We.defaultProps={jimpImage:void 0,filename:"output"};var Ne=We,Le=a.p+"static/media/logo.42e2fcaf.svg",Te="2022-06-15.11d259b",Ge="https://github.com/micheldebree/retropixels/commit/11d259b14c182b8aa300b5459cd0f438664a5ef3",He=Object(f.a)(),_e=Object(m.a)((function(){return{root:{flexGrow:1},menuButton:{marginRight:He.spacing(2)},title:{flexGrow:1}}}));var Je=function(){var e=Object(n.useState)(void 0),t=Object(o.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(void 0),h=Object(o.a)(i,2),m=h[0],f=h[1],x=_e(),g=Object(n.useCallback)((function(e){c(e.jimpImage),f(e.filename)}),[c,f]);return Object(L.jsx)(p.a,{theme:He,children:Object(L.jsxs)("div",{className:"App",children:[Object(L.jsx)("div",{className:x.root,children:Object(L.jsx)(r.a,{position:"static",children:Object(L.jsxs)(l.a,{variant:"dense",children:[Object(L.jsx)("img",{src:Le,alt:"Logo",className:"logo"}),Object(L.jsx)(s.a,{variant:"h6",className:x.title,align:"left",children:"Retropixels"}),Object(L.jsxs)(j.a,{href:Ge,color:"inherit",variant:"body2",children:["v",Te]}),Object(L.jsx)(b.a,{color:"inherit",href:"https://github.com/micheldebree/retropixels",children:Object(L.jsx)(O.a,{})})]})})}),Object(L.jsx)(d.a,{align:"left",children:Object(L.jsxs)(s.a,{variant:"overline",children:["Convert images to ",Object(L.jsx)(j.a,{href:"https://en.wikipedia.org/wiki/Commodore_64",children:"Commodore 64"})," format"]})}),Object(L.jsxs)(u.a,{container:!0,spacing:3,children:[Object(L.jsx)(u.a,{item:!0,xs:12,sm:6,md:4,children:Object(L.jsx)(je,{onChanged:g})}),Object(L.jsx)(u.a,{item:!0,xs:12,sm:6,md:8,children:Object(L.jsx)(Ne,{jimpImage:a,filename:m})})]})]})})},Ue=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,588)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),c(e),i(e),o(e)}))},qe=document.getElementById("root");Object(i.createRoot)(qe).render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(Je,{})})),Ue()}},[[509,1,2]]]);
//# sourceMappingURL=main.41106c5c.chunk.js.map